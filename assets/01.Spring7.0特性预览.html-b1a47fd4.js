import{_ as p,V as o,W as c,X as n,Y as s,Z as t,a0 as e,F as i}from"./framework-23f3cf9b.js";const l={},u=n("p",null,"Spring å®˜æ–¹å·²ç»å‘å¸ƒäº† Spring Boot 4.0 çš„å¿«ç…§ç‰ˆæœ¬ï¼Œå†…ç½® Spring Framework 7.0ã€‚",-1),r=n("p",null,"æ¥ä¸‹æ¥æˆ‘ä»¬å¿«é€Ÿé¢„è§ˆä¸€ä¸‹Spring7.0åˆå¸¦æ¥äº†å“ªäº›æ”¹å˜",-1),d={href:"https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-7.0-Release-Notes",target:"_blank",rel:"noopener noreferrer"},k=e(`<h2 id="_1-æœ€ä½ç¯å¢ƒè¦æ±‚" tabindex="-1"><a class="header-anchor" href="#_1-æœ€ä½ç¯å¢ƒè¦æ±‚" aria-hidden="true">#</a> 1. æœ€ä½ç¯å¢ƒè¦æ±‚</h2><p>JDKçš„ç‰ˆæœ¬è¦æ±‚æ²¡æœ‰å˜æ›´ï¼Œ JDK 17-27 å‡æ”¯æŒ</p><ul><li>Jakarta EE 11 (Tomcat 11+)</li><li>Kotlin 2.x</li><li>JSONassert 2.0</li><li>GraalVM 23</li></ul><h2 id="_2-ç§»é™¤çš„api" tabindex="-1"><a class="header-anchor" href="#_2-ç§»é™¤çš„api" aria-hidden="true">#</a> 2. ç§»é™¤çš„API</h2><h3 id="_2-1-spring-jcl-åœç”¨" tabindex="-1"><a class="header-anchor" href="#_2-1-spring-jcl-åœç”¨" aria-hidden="true">#</a> 2.1 Spring JCL åœç”¨</h3><p><code>Java Commons Loggingï¼ˆJCLï¼‰</code> æ˜¯ Apache æä¾›çš„æ—¥å¿—é—¨é¢ï¼ˆFacadeï¼‰ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡ç»Ÿä¸€æ¥å£è°ƒç”¨ä¸åŒåº•å±‚æ—¥å¿—æ¡†æ¶;</p><h3 id="_2-2-ç§»é™¤-javax-annotation-å’Œ-javax-injectæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#_2-2-ç§»é™¤-javax-annotation-å’Œ-javax-injectæ³¨è§£" aria-hidden="true">#</a> 2.2 ç§»é™¤ <code>javax.annotation</code> å’Œ <code>javax.inject</code>æ³¨è§£</h3><p>è¿™ä¸¤ä¸ªåŒ…ä¸‹æˆ‘ä»¬å¸¸è§çš„æ³¨è§£æœ‰ <code>@Resource</code> ï¼Œ <code>@PostConstruct</code>, <code>@Inject</code>ï¼Œè¿™äº›åœ¨SpringBoot2+çš„ç”Ÿæ€ä¸‹ï¼Œåº”è¯¥æ˜¯éå¸¸å¸¸è§çš„ä½¿ç”¨æ³¨è§£äº†ï¼Œå¦‚æœä½ åœ¨SpringBoot4(Spring7)ä¹‹åç»§ç»­ä½¿ç”¨ï¼Œé‚£ä¹ˆéœ€è¦æ”¹æˆ <code>jakarta.annotation</code> å’Œ <code>jakarta.inject packages</code>ä¸‹çš„ä¾èµ–</p><h3 id="_2-3-è·¯å¾„æ˜ å°„é€‰é¡¹åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_2-3-è·¯å¾„æ˜ å°„é€‰é¡¹åˆ é™¤" aria-hidden="true">#</a> 2.3 è·¯å¾„æ˜ å°„é€‰é¡¹åˆ é™¤</h3><p>è‡ª 6.0 ç‰ˆæœ¬ä»¥æ¥ï¼Œå¤šä¸ªè·¯å¾„æ˜ å°„é€‰é¡¹å·²è¢«æ ‡è®°ä¸ºåˆ é™¤ã€‚ ä¸‹é¢è¿™äº›é€‰é¡¹ç°å·²è¢«å½»åº•åˆ é™¤ã€‚ å…¶ä¸­åŒ…æ‹¬ï¼š</p><ol><li><code>suffixPatternMatch</code>/<code>registeredSuffixPatternMatch</code> æ³¨è§£æ§åˆ¶æ–¹æ³•</li></ol><p>æ§åˆ¶æ˜¯å¦å…è®¸é€šè¿‡ <strong>URL è·¯å¾„åç¼€</strong>ï¼ˆå¦‚ .jsonã€.xmlï¼‰åŒ¹é…æ§åˆ¶å™¨æ–¹æ³•ã€‚</p><ul><li><code>suffixPatternMatch=true</code>ï¼šå…è®¸é€šè¿‡åç¼€åŒ¹é…ï¼ˆä¾‹å¦‚ /data.json æ˜ å°„åˆ° @RequestMapping(&quot;/data&quot;)ï¼‰ã€‚</li><li><code>registeredSuffixPatternMatch=true</code>ï¼šä»…å…è®¸åŒ¹é…å·²æ³¨å†Œçš„åç¼€ï¼ˆéœ€é…åˆ ContentNegotiationManager é…ç½®ï¼‰ã€‚</li></ul><p>ä¸€ä¸ªç®€å•ä½¿ç”¨åœºæ™¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebMvc</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configurePathMatch</span><span class="token punctuation">(</span><span class="token class-name">PathMatchConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        configurer<span class="token punctuation">.</span><span class="token function">setUseSuffixPatternMatch</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// å¯ç”¨åç¼€åŒ¹é…</span>
                  <span class="token punctuation">.</span><span class="token function">setUseRegisteredSuffixPatternMatch</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä»…åŒ¹é…å·²æ³¨å†Œåç¼€</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„</strong>ï¼š</p><ul><li>å¯ç”¨åç¼€åŒ¹é…å¯èƒ½å¯¼è‡´å®‰å…¨é£é™©ï¼ˆå¦‚é€šè¿‡ .jsp è®¿é—®æœªæˆæƒèµ„æºï¼‰ï¼Œå»ºè®®ç»“åˆç™½åå•ä½¿ç”¨ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒregisteredSuffixPatternMatch ä¸º falseã€‚</li></ul><ol start="2"><li><code>trailingSlashMatch</code> ï¼ˆAbstractHandlerMapping æ‰©å±•ï¼‰</li></ol><p><strong>ä½œç”¨</strong>ï¼š æ§åˆ¶æ˜¯å¦å¿½ç•¥ URL æœ«å°¾çš„æ–œæ ï¼ˆ/ï¼‰ã€‚</p><ul><li>trailingSlashMatch=trueï¼š/path å’Œ /path/ è§†ä¸ºåŒä¸€è·¯å¾„ã€‚</li><li>trailingSlashMatch=falseï¼šä¸¥æ ¼åŒºåˆ†æœ«å°¾æ–œæ ã€‚</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configurePathMatch</span><span class="token punctuation">(</span><span class="token class-name">PathMatchConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    configurer<span class="token punctuation">.</span><span class="token function">setUseTrailingSlashMatch</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸¥æ ¼åŒ¹é…æœ«å°¾æ–œæ </span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š Spring Boot 2.3+ é»˜è®¤ç¦ç”¨æœ«å°¾æ–œæ åŒ¹é…ï¼Œéœ€æ‰‹åŠ¨å¯ç”¨ã€‚</p><ol start="3"><li>å†…å®¹åå•†é…ç½®</li></ol><p><strong>favorPathExtension / ignoreUnknownPathExtensions</strong></p><p><em>ä½œç”¨</em>ï¼š</p><ul><li>favorPathExtension=trueï¼šä¼˜å…ˆé€šè¿‡ URL åç¼€ï¼ˆå¦‚ .jsonï¼‰å†³å®šå“åº”å†…å®¹ç±»å‹ã€‚</li><li>ignoreUnknownPathExtensions=trueï¼šå¿½ç•¥æœªè¯†åˆ«çš„åç¼€ï¼ˆè¿”å›é»˜è®¤å†…å®¹ç±»å‹ï¼‰ã€‚</li></ul><p><em>å…³è”ç­–ç•¥ç±»</em>ï¼š</p><ul><li>PathExtensionContentNegotiationStrategyï¼šåŸºäºè·¯å¾„åç¼€åå•†ã€‚</li><li>ServletPathExtensionContentNegotiationStrategyï¼šåŸºäº Servlet å®¹å™¨ç‰¹æ€§åå•†ã€‚</li></ul><p><em>Java Config ç¤ºä¾‹</em>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ContentNegotiationManagerFactoryBean</span> <span class="token function">contentNegotiationManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ContentNegotiationManagerFactoryBean</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentNegotiationManagerFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    factory<span class="token punctuation">.</span><span class="token function">setFavorPathExtension</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    factory<span class="token punctuation">.</span><span class="token function">setIgnoreUnknownExtensions</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> factory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>MVC Java Config</em></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>@Override
public void configureContentNegotiation(ContentNegotiationConfigurer configurer) {
    configurer.favorPathExtension(true)
              .ignoreUnknownExtensions(true);
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>è·¯å¾„æ¨¡å¼è§£æé…ç½®</li></ol><p><strong><code>matchOptionalTrailingSeparator</code> in <code>PathPatternParser</code></strong></p><p><em>ä½œç”¨</em>ï¼š æ§åˆ¶è·¯å¾„åŒ¹é…æ—¶æ˜¯å¦å…è®¸å¯é€‰çš„å°¾éƒ¨æ–œæ ã€‚</p><ul><li>trueï¼š/path å’Œ /path/ åŒ¹é…åŒä¸€æ§åˆ¶å™¨æ–¹æ³•ã€‚</li><li>falseï¼šä¸¥æ ¼åŒºåˆ†å°¾éƒ¨æ–œæ ã€‚</li></ul><p><em>é…ç½®ç¤ºä¾‹</em>ï¼ˆSpring Boot 2.3+ï¼‰</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># application.properties</span>
<span class="token key attr-name">spring.mvc.pathmatch.matching-strategy</span><span class="token punctuation">=</span><span class="token value attr-value">ant_path_matcher</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>éœ€é…åˆ PathPatternParser ä½¿ç”¨ï¼ˆé»˜è®¤ç­–ç•¥ä¸º AntPathMatcherï¼‰</p><h2 id="_3-å¼ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_3-å¼ƒç”¨" aria-hidden="true">#</a> 3.å¼ƒç”¨</h2><ol><li>Spring MVC çš„ <code>&lt;mvc:*&gt;</code> XML é…ç½®å‘½åç©ºé—´ç°å·²å¼ƒç”¨ï¼Œæ¨èæ”¹ç”¨ Java é…ç½®æ–¹å¼ã€‚ç›®å‰æš‚æ— å®Œå…¨ç§»é™¤ XML é…ç½®çš„è®¡åˆ’ï¼Œä½†åç»­æ›´æ–°å°†ä¸å†é€‚é… Java é…ç½®æ¨¡å‹ã€‚å…¶ä»–å‘½åç©ºé—´ï¼ˆå¦‚ <code>&lt;bean&gt;</code>ï¼‰æœªå¼ƒç”¨ã€‚</li><li>Kotlin å›¢é˜Ÿè®¡åˆ’åœ¨æœªæ¥çš„ Kotlin 2.x ç‰ˆæœ¬ä¸­ç§»é™¤å¯¹ JSR 223 çš„æ”¯æŒï¼Œå› æ­¤ Spring ä¸­é’ˆå¯¹ Kotlin è„šæœ¬çš„æ¨¡æ¿åŠŸèƒ½å·²è¢«æ ‡è®°ä¸ºå¼ƒç”¨ã€‚</li><li>Spring TestContext Framework å¯¹ JUnit 4 çš„æ”¯æŒå·²å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ JUnit Jupiter çš„ SpringExtensionã€‚<br> å¼ƒç”¨çš„ç±»åŒ…æ‹¬ï¼š <ul><li>SpringRunner</li><li>SpringClassRule</li><li>SpringMethodRule</li><li>AbstractJUnit4SpringContextTests</li><li>AbstractTransactionalJUnit4SpringContextTestsåŠç›¸å…³æ”¯æŒç±»ã€‚</li></ul></li><li>Jackson 2.x çš„æ”¯æŒå·²å¼ƒç”¨ï¼Œæ¨èè¿ç§»åˆ° Jackson 3.x</li></ol><h2 id="_4-nullå®‰å…¨" tabindex="-1"><a class="header-anchor" href="#_4-nullå®‰å…¨" aria-hidden="true">#</a> 4. Nullå®‰å…¨</h2><p>æ–°ç‰ˆæœ¬é‡‡ç”¨ JSpecify æ³¨è§£æ¥å£°æ˜ API çš„ç©ºå€¼å®‰å…¨æ€§ï¼Œä½¿ç”¨ @Nullable è¡¨ç¤ºå¯ä¸º Nullï¼Œä½¿ç”¨ @NonNull è¡¨ç¤ºä¸èƒ½ä¸ºç©ºï¼Œå¹¶ä¸”ä¼šé€šè¿‡ Idea é…åˆæç¤ºè­¦å‘Šæˆ–é”™è¯¯ä¿¡æ¯ï¼Œä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>jspecify<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">NonNull</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>jspecify<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Nullable</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Nullable</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-httpä»£ç†" tabindex="-1"><a class="header-anchor" href="#_5-httpä»£ç†" aria-hidden="true">#</a> 5. HTTPä»£ç†</h2><p>æ–°ç‰ˆæœ¬æä¾›äº† @ImportHttpServices æ³¨è§£ï¼Œè®©ä½ ä¸º HTTP æ¥å£åˆ›å»ºä»£ç†æ›´åŠ å®¹æ˜“ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼ˆå®ƒå…è®¸æ‚¨è½»æ¾å£°æ˜ã€æ£€æµ‹å’Œé…ç½®æ•´ä¸ª HTTP æœåŠ¡ç»„ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ImportHttpServices</span><span class="token punctuation">(</span>group <span class="token operator">=</span> <span class="token string">&quot;weather&quot;</span><span class="token punctuation">,</span> types <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">FreeWeather</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">CommercialWeather</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ImportHttpServices</span><span class="token punctuation">(</span>group <span class="token operator">=</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> types <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">UserServiceInternal</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UserServiceOfficial</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">HttpServicesConfiguration</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractHttpServiceRegistrar</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">RestClientHttpServiceGroupConfigurer</span> <span class="token function">groupConfigurer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> groups <span class="token operator">-&gt;</span> groups<span class="token punctuation">.</span><span class="token function">filterByName</span><span class="token punctuation">(</span><span class="token string">&quot;weather&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">configureClient</span><span class="token punctuation">(</span><span class="token punctuation">(</span>group<span class="token punctuation">,</span> builder<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> builder<span class="token punctuation">.</span><span class="token function">defaultHeader</span><span class="token punctuation">(</span><span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;My-Application&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-beanæ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#_6-beanæ³¨å…¥" aria-hidden="true">#</a> 6. Beanæ³¨å…¥</h2><p>Bean æ³¨å†Œå™¨å®ç°ä½¿ç”¨ BeanRegistry å’Œ Environment APIï¼Œä»¥ç®€æ´çµæ´»çš„æ–¹å¼é€šè¿‡ç¼–ç¨‹æ–¹å¼æ³¨å†Œ Beanã€‚ä¾‹å¦‚ï¼Œå®ƒå…è®¸é€šè¿‡ if è¡¨è¾¾å¼ã€for å¾ªç¯ç­‰è¿›è¡Œè‡ªå®šä¹‰æ³¨å†Œã€‚</p><p>åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨Configurationæ¥æ³¨å†Œbeanï¼Œå¦‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">MyBeanRegistrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">MyConfiguration</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨åˆ™å¯ä»¥é€šè¿‡å®ç°<code>BeanRegistrar</code>æ¥å®ç°æ›´çµæ´»çš„beanæ³¨å†Œ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MyBeanRegistrar</span> <span class="token keyword">implements</span> <span class="token class-name">BeanRegistrar</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">BeanRegistry</span> registry<span class="token punctuation">,</span> <span class="token class-name">Environment</span> env<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">registerBean</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registry<span class="token punctuation">.</span><span class="token function">registerBean</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Bar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> spec <span class="token operator">-&gt;</span> spec
                <span class="token punctuation">.</span><span class="token function">prototype</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">lazyInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;Custom description&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">supplier</span><span class="token punctuation">(</span>context <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">bean</span><span class="token punctuation">(</span><span class="token class-name">Foo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">matchesProfiles</span><span class="token punctuation">(</span><span class="token string">&quot;baz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            registry<span class="token punctuation">.</span><span class="token function">registerBean</span><span class="token punctuation">(</span><span class="token class-name">Baz</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> spec <span class="token operator">-&gt;</span> spec
                    <span class="token punctuation">.</span><span class="token function">supplier</span><span class="token punctuation">(</span>context <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Baz</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-æ¥å£ç‰ˆæœ¬æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#_7-æ¥å£ç‰ˆæœ¬æ§åˆ¶" aria-hidden="true">#</a> 7. æ¥å£ç‰ˆæœ¬æ§åˆ¶</h2><p>æ–°ç‰ˆæœ¬å¼•å…¥äº†ä¼˜é›…çš„ API ç‰ˆæœ¬æ§åˆ¶æ”¯æŒï¼Œå…è®¸å¼€å‘è€…é€šè¿‡ @RequestMapping æ³¨è§£ä¸­çš„ version å‚æ•°æ¥å®ç°ç‰ˆæœ¬æ§åˆ¶ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤º</p>`,55),v={href:"https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-7.0-Release-Notes",target:"_blank",rel:"noopener noreferrer"},m=e(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/account/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountController</span> <span class="token punctuation">{</span>

	<span class="token comment">// 1</span>
	<span class="token annotation punctuation">@GetMapping</span>  
	<span class="token keyword">public</span> <span class="token class-name">Account</span> <span class="token function">getAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 2</span>
	<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.1&quot;</span><span class="token punctuation">)</span> 
	<span class="token keyword">public</span> <span class="token class-name">Account</span> <span class="token function">getAccount1_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 3</span>
	<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.2+&quot;</span><span class="token punctuation">)</span> 
	<span class="token keyword">public</span> <span class="token class-name">Account</span> <span class="token function">getAccount1_2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 4</span>
	<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.5&quot;</span><span class="token punctuation">)</span> 
	<span class="token keyword">public</span> <span class="token class-name">Account</span> <span class="token function">getAccount1_5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>åŒ¹é…ä»»ä½•ç‰ˆæœ¬</li><li>åŒ¹é… version 1.1</li><li>åŒ¹é… 1.2 and above</li><li>åŒ¹é… 1.5</li></ol><p>ç„¶åé€šè¿‡è¯·æ±‚å‚æ•°æ¥æ§åˆ¶ä¸åŒçš„ç‰ˆæœ¬ï¼Œv1/v2çš„è¯·æ±‚åˆ†åˆ«ä¸º</p>`,3),g={href:"http://localhost:8080/account/1?version=1",target:"_blank",rel:"noopener noreferrer"},b={href:"http://localhost:8080/account/1?version=1.1",target:"_blank",rel:"noopener noreferrer"},h={href:"http://localhost:8080/account/1?version=1.3",target:"_blank",rel:"noopener noreferrer"},f={href:"http://localhost:8080/account/1?version=1.5",target:"_blank",rel:"noopener noreferrer"},y={href:"http://localhost:8080/account/1?version=1.6",target:"_blank",rel:"noopener noreferrer"},_=n("ul",null,[n("li",null,"è¿™ç§åœºæ™¯è¡¨ç¤ºå½“å‰è¯·æ±‚çš„ç‰ˆæœ¬æ¯”æˆ‘ä»¬æœåŠ¡æä¾›çš„æœ€å¤§ç‰ˆæœ¬è¿˜é«˜ï¼Œä¸å“åº”")],-1),w=e(`<h2 id="_8-å…¶ä»–ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_8-å…¶ä»–ä¼˜åŒ–" aria-hidden="true">#</a> 8.å…¶ä»–ä¼˜åŒ–</h2><ol><li>SPEL è¡¨è¾¾å¼å‡çº§ï¼šSPEL è¡¨è¾¾å¼ä¸­æ”¯æŒç©ºå®‰å…¨å’Œ Elvis è¿ç®—ç¬¦ï¼Œä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{systemProperties[&#39;pop3.port&#39;] ?: 25}&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å®ƒè¡¨ç¤ºï¼Œå°†æ³¨å…¥ç³»ç»Ÿå±æ€§ pop3.port çš„å€¼ï¼Œå¦‚æœæœªå®šä¹‰è¯¥å±æ€§å€¼ï¼Œæ³¨å…¥ 25 è¿™ä¸ªå€¼ã€‚</p><ol start="2"><li><p>GraalVM åŸç”Ÿåº”ç”¨æ”¯æŒï¼šå€ŸåŠ© Spring AOT æŠ€æœ¯ï¼Œå°†åº”ç”¨ç¼–è¯‘æˆåŸç”Ÿé•œåƒï¼Œæå¤§åœ°ç¼©çŸ­äº†å¯åŠ¨æ—¶é—´ã€‚</p></li><li><p>æ”¯æŒ Jackson 3.xï¼šæ”¾å¼ƒå¯¹ Jackson 2.x çš„æ”¯æŒï¼Œå‡çº§ä¸º Jackson 3.xã€‚</p></li><li><p>Servlet å’Œ WebSocket ç‰ˆæœ¬å‡çº§ï¼šä½¿ç”¨ Servlet 6.1 å’Œ WebSocket 2.2 ä½œä¸º Web åº”ç”¨ç¨‹åºçš„åº•å±‚å®ç°ï¼Œè¿™æ„å‘³ç€åº”ç”¨ç¨‹åºåº”è¯¥éƒ¨ç½²åœ¨æœ€æ–°çš„ Servlet å®¹å™¨ä¸Šï¼Œæ¯”å¦‚ Tomcat 11+ å’Œ Jetty 12.1+ã€‚</p></li><li><p>HttpHeaders ä¼˜åŒ–ï¼šHttpHeaders æ“ä½œå¦‚ä¸‹ï¼š</p></li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/headers&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">HttpHeaders</span> headers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ—§æ–¹å¼ï¼ˆå·²åºŸå¼ƒï¼‰</span>
        <span class="token comment">// headers.getFirst(&quot;X-Custom-Header&quot;);</span>

        <span class="token comment">// æ–°æ–¹å¼</span>
        <span class="token class-name">String</span> value <span class="token operator">=</span> headers<span class="token punctuation">.</span><span class="token function">firstValue</span><span class="token punctuation">(</span><span class="token string">&quot;X-Custom-Header&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// éå†æ‰€æœ‰å¤´éƒ¨</span>
        headers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> values<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token string">&quot;Processed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_9-å°ç»“" aria-hidden="true">#</a> 9.å°ç»“</h2><p>SpringBoot3+éƒ½è¿˜æ²¡å°ä¸Šé²œï¼Œè¿™ä¸‹4.0å°±æ¥äº†ï¼Œè¿˜åœ¨ç”¨java8çš„å°ä¼™ä¼´ï¼Œä½ ä»¬è¿˜å­¦å¾—åŠ¨å—ğŸ˜­</p>`,8);function x(S,j){const a=i("ExternalLinkIcon");return o(),c("div",null,[u,r,n("blockquote",null,[n("p",null,[s("ä»¥ä¸‹æ‰€æœ‰å†…å®¹æ¥è‡ªå®˜æ–¹WiKi: "),n("a",d,[s("Spring-Framework-7.0-Release-Notes"),t(a)])])]),k,n("blockquote",null,[n("p",null,[n("a",v,[s("https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-7.0-Release-Notes"),t(a)])])]),m,n("ul",null,[n("li",null,[n("a",g,[s("http://localhost:8080/account/1?version=1"),t(a)]),s(" getAccount()")]),n("li",null,[n("a",b,[s("http://localhost:8080/account/1?version=1.1"),t(a)]),s(" å¯¹åº” getAccount1_1()")]),n("li",null,[n("a",h,[s("http://localhost:8080/account/1?version=1.3"),t(a)]),s(" å¯¹åº” getAccount1_2()ï¼Œ å› ä¸ºæ²¡æœ‰ç›´æ¥çš„1.3ç‰ˆæœ¬ï¼Œå› æ­¤æ‰¾æœ€è¿‘çš„ä¸€ä¸ªæ»¡è¶³çš„")]),n("li",null,[n("a",f,[s("http://localhost:8080/account/1?version=1.5"),t(a)]),s(" å¯¹åº” getAccount1_5()")]),n("li",null,[n("a",y,[s("http://localhost:8080/account/1?version=1.6"),t(a)]),s(" æ­£å¸¸1ã€3éƒ½å¯ä»¥åŒ¹é…ï¼Œä½†æ˜¯å› ä¸ºæœ‰äº†4å¯¹åº”çš„1.5ç‰ˆæœ¬ï¼Œä½†æ˜¯æ²¡æœ‰1.6ç‰ˆæœ¬ï¼Œåˆ™1ã€3éƒ½æ— æ³•æ­£ç¡®å“åº”ï¼Œè¿”å›400é”™è¯¯ "),_])]),w])}const M=p(l,[["render",x],["__file","01.Spring7.0ç‰¹æ€§é¢„è§ˆ.html.vue"]]);export{M as default};
