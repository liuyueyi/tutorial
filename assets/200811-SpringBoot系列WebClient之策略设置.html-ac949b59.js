import{_ as p,V as e,W as o,X as c,Z as n,a1 as s,$ as t,Y as l,F as i}from"./framework-b1bd8911.js";const u="/tutorial/imgs/200811/00.jpg",r={},k=n("p",null,[s("åœ¨å‰é¢ä»‹ç»WebClientçš„å¸¸è§å‚æ•°ä¸­ï¼Œæœ‰ä¸€ä¸ª"),n("code",null,"exchangeStrategies"),s("å‚æ•°è®¾ç½®ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¼ è¾“æ•°æ®çš„å†…å­˜å ç”¨å¤§å°é™åˆ¶ï¼Œé¿å…å†…å­˜é—®é¢˜ï¼›ä¹Ÿå¯ä»¥é€šè¿‡å®ƒè®¾ç½®æ•°æ®çš„ç¼–è§£ç ")],-1),d=l(`<h2 id="i-é¡¹ç›®ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#i-é¡¹ç›®ç¯å¢ƒ" aria-hidden="true">#</a> I. é¡¹ç›®ç¯å¢ƒ</h2><p>æœ¬é¡¹ç›®å€ŸåŠ©<code>SpringBoot 2.2.1.RELEASE</code> + <code>maven 3.5.3</code> + <code>IDEA</code>è¿›è¡Œå¼€å‘</p><h3 id="_1-ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-ä¾èµ–" aria-hidden="true">#</a> 1. ä¾èµ–</h3><p>ä½¿ç”¨WebClientï¼Œæœ€ä¸»è¦çš„å¼•å…¥ä¾èµ–å¦‚ä¸‹ï¼ˆçœç•¥æ‰äº†SpringBootçš„ç›¸å…³ä¾èµ–ï¼Œå¦‚å¯¹äºå¦‚ä½•åˆ›å»ºSpringBooté¡¹ç›®ä¸å¤ªæ¸…æ¥šçš„å°ä¼™ä¼´ï¼Œå¯ä»¥å…³æ³¨ä¸€ä¸‹æˆ‘ä¹‹å‰çš„åšæ–‡ï¼‰</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-webflux<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-æµ‹è¯•æ¥å£" tabindex="-1"><a class="header-anchor" href="#_2-æµ‹è¯•æ¥å£" aria-hidden="true">#</a> 2. æµ‹è¯•æ¥å£</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Body</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1210673970258821332L</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">&quot;req: &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot; age: &quot;</span> <span class="token operator">+</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;body2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Body</span><span class="token punctuation">&gt;</span></span> <span class="token function">postBody2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span>  <span class="token class-name">Body</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Mono</span><span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ii-ä½¿ç”¨è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ii-ä½¿ç”¨è¯´æ˜" aria-hidden="true">#</a> II. ä½¿ç”¨è¯´æ˜</h2><h3 id="_1-maxinmemorysizeè®¾ç½®" tabindex="-1"><a class="header-anchor" href="#_1-maxinmemorysizeè®¾ç½®" aria-hidden="true">#</a> 1. MaxInMemorySizeè®¾ç½®</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå†…å­˜ä¸­æ¥æ”¶æ•°æ®çš„buffering data sizeä¸º256KBï¼Œå¯ä»¥æ ¹æ®å®é™…çš„éœ€è¦è¿›è¡Œæ”¹å¤§orè°ƒå°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// é»˜è®¤å…è®¸çš„å†…å­˜ç©ºé—´å¤§å°ä¸º256KBï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼è¿›è¡Œä¿®æ”¹</span>
webClient <span class="token operator">=</span> <span class="token class-name">WebClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exchangeStrategies</span><span class="token punctuation">(</span>
        <span class="token class-name">ExchangeStrategies</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">codecs</span><span class="token punctuation">(</span>codec <span class="token operator">-&gt;</span> codec<span class="token punctuation">.</span><span class="token function">defaultCodecs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxInMemorySize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8080&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> argument <span class="token operator">=</span> <span class="token string">&quot;è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„æ–‡æœ¬ï¼Œç”¨äºæµ‹è¯•è¶…å‡ºä¸Šé™!&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ans <span class="token operator">=</span> webClient<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;/get?name={1}&quot;</span><span class="token punctuation">,</span> argument<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token comment">// å¼‚å¸¸å¤„ç†</span>
        <span class="token punctuation">.</span><span class="token function">doOnError</span><span class="token punctuation">(</span><span class="token class-name">WebClientResponseException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> err <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">getRawStatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span><span class="token function">getResponseBodyAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onErrorReturn</span><span class="token punctuation">(</span><span class="token string">&quot;fallback&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ans<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;exchange strategy: &quot;</span> <span class="token operator">+</span> ans<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-ç¼–è§£ç è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#_2-ç¼–è§£ç è®¾ç½®" aria-hidden="true">#</a> 2. ç¼–è§£ç è®¾ç½®</h3><p>æ¯”å¦‚æœ€å¸¸è§çš„jsonç¼–è§£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">WebClient</span> webClient <span class="token operator">=</span> <span class="token class-name">WebClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exchangeStrategies</span><span class="token punctuation">(</span><span class="token class-name">ExchangeStrategies</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">codecs</span><span class="token punctuation">(</span>codec <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    codec<span class="token punctuation">.</span><span class="token function">customCodecs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decoder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Jackson2JsonDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    codec<span class="token punctuation">.</span><span class="token function">customCodecs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encoder</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Jackson2JsonEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">baseUrl</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8080&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Body</span> body <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Body</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸€ç°ç°ğŸ˜&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Body</span><span class="token punctuation">&gt;</span></span> ans <span class="token operator">=</span>
        webClient<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">&quot;/body2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_JSON</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bodyValue</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">bodyToMono</span><span class="token punctuation">(</span><span class="token class-name">Body</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ans<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;retreive res: &quot;</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä¸¤ä¸ªæµ‹è¯•ä¹‹åï¼Œè¿”å›ç»“æœå¦‚ä¸‹</p><figure><img src="`+u+'" alt="IMAGE" tabindex="0" loading="lazy"><figcaption>IMAGE</figcaption></figure><h2 id="ii-å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#ii-å…¶ä»–" aria-hidden="true">#</a> II. å…¶ä»–</h2><h3 id="_0-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_0-é¡¹ç›®" aria-hidden="true">#</a> 0. é¡¹ç›®</h3><p><strong>ç³»åˆ—åšæ–‡</strong></p>',19),g={href:"http://spring.hhui.top/spring-blog/2020/08/03/200803-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8B%E9%9D%9E200%E7%8A%B6%E6%80%81%E7%A0%81%E4%BF%A1%E6%81%AF%E6%8D%95%E8%8E%B7/",target:"_blank",rel:"noopener noreferrer"},b={href:"http://spring.hhui.top/spring-blog/2020/07/28/200728-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8Bretrieve%E4%B8%8Eexchange%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8C%BA%E5%88%AB%E4%BB%8B%E7%BB%8D/",target:"_blank",rel:"noopener noreferrer"},m={href:"http://spring.hhui.top/spring-blog/2020/07/17/200717-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8B%E8%B6%85%E6%97%B6%E8%AE%BE%E7%BD%AE/",target:"_blank",rel:"noopener noreferrer"},v={href:"http://spring.hhui.top/spring-blog/2020/07/16/200716-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8BBasic-Auth%E6%8E%88%E6%9D%83/",target:"_blank",rel:"noopener noreferrer"},h={href:"http://spring.hhui.top/spring-blog/2020/07/14/200714-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8B%E8%AF%B7%E6%B1%82%E5%A4%B4%E8%AE%BE%E7%BD%AE/",target:"_blank",rel:"noopener noreferrer"},B={href:"http://spring.hhui.top/spring-blog/2020/07/13/200713-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/",target:"_blank",rel:"noopener noreferrer"},E={href:"http://spring.hhui.top/spring-blog/2020/07/09/200709-SpringBoot%E7%B3%BB%E5%88%97WebClient%E4%B9%8B%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%E5%A7%BF%E5%8A%BF/",target:"_blank",rel:"noopener noreferrer"},f=n("p",null,[n("strong",null,"æºç ")],-1),_={href:"https://github.com/liuyueyi/spring-boot-demo",target:"_blank",rel:"noopener noreferrer"},y={href:"https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/222-web-client",target:"_blank",rel:"noopener noreferrer"};function x(C,S){const a=i("ExternalLinkIcon");return e(),o("div",null,[k,c(" more "),d,n("ul",null,[n("li",null,[n("a",g,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹é200çŠ¶æ€ç ä¿¡æ¯æ•è·"),t(a)])]),n("li",null,[n("a",b,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹retrieveä¸exchangeçš„ä½¿ç”¨åŒºåˆ«ä»‹ç»"),t(a)])]),n("li",null,[n("a",m,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹è¶…æ—¶è®¾ç½®"),t(a)])]),n("li",null,[n("a",v,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹Basic Authæˆæƒ"),t(a)])]),n("li",null,[n("a",h,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹è¯·æ±‚å¤´è®¾ç½®"),t(a)])]),n("li",null,[n("a",B,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹æ–‡ä»¶ä¸Šä¼ "),t(a)])]),n("li",null,[n("a",E,[s("ã€WEBç³»åˆ—ã€‘WebClientä¹‹åŸºç¡€ä½¿ç”¨å§¿åŠ¿"),t(a)])])]),f,n("ul",null,[n("li",null,[s("å·¥ç¨‹ï¼š"),n("a",_,[s("https://github.com/liuyueyi/spring-boot-demo"),t(a)])]),n("li",null,[s("æºç ï¼š"),n("a",y,[s("https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/222-web-client"),t(a)])])])])}const A=p(r,[["render",x],["__file","200811-SpringBootç³»åˆ—WebClientä¹‹ç­–ç•¥è®¾ç½®.html.vue"]]);export{A as default};
