import{_ as p,V as e,W as o,a1 as c,Y as n,Z as s,$ as t,X as l,F as i}from"./framework-eef79181.js";const u="/tutorial/imgs/200710/00.jpg",r={},k=n("p",null,"è™½ç„¶åœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œå€ŸåŠ©RestTemplateæ¥å®ç°æ–‡ä»¶ä¸Šä¼ çš„æœºä¼šä¸å¤šï¼ˆæ¯”å¦‚æˆ‘å·²ç»å¼€webclientçš„æ–°å‘äº†ï¼Œæ‰å‘ç°å¿˜äº†è¿™è´§...ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªçŸ¥è¯†ç‚¹ä¹Ÿè¿˜æ˜¯æœ‰å¿…è¦äº†è§£ä¸€ä¸‹çš„ï¼Œæœ¬æ–‡å°†ç®€å•ä»‹ç»ä¸€ä¸‹å•ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œå¤šä¸ªæ–‡ä»¶ä¸Šä¼ çš„ä½¿ç”¨å§¿åŠ¿",-1),d=l(`<h2 id="i-é¡¹ç›®æ­å»º" tabindex="-1"><a class="header-anchor" href="#i-é¡¹ç›®æ­å»º" aria-hidden="true">#</a> I. é¡¹ç›®æ­å»º</h2><p>æœ¬é¡¹ç›®åŸºäºSpringBoot <code>2.2.1.RELEASE</code> + <code>maven 3.5.3</code> + <code>idea</code>è¿›è¡Œå¼€å‘</p><h3 id="_1-pomä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-pomä¾èµ–" aria-hidden="true">#</a> 1. pomä¾èµ–</h3><p>æ ¸å¿ƒpomä¾èµ–å¦‚ä¸‹</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-restæœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_2-restæœåŠ¡" aria-hidden="true">#</a> 2. RestæœåŠ¡</h3><p>æä¾›ä¸¤ä¸ªç®€å•çš„ä¸Šä¼ æ–‡ä»¶çš„æ¥å£ï¼Œä¸‹é¢ç»™å‡ºä¸¤ç§ä¸ä¸€æ ·çš„å†™æ³•ï¼Œæ•ˆæœå·®ä¸å¤š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ–‡ä»¶ä¸Šä¼ 
 *
 * <span class="token keyword">@param</span> <span class="token parameter">file</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestPart</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;|&quot;</span> <span class="token operator">+</span> name<span class="token punctuation">;</span>
    <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;upload2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartHttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MultipartFile</span><span class="token punctuation">&gt;</span></span> files <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getFiles</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file <span class="token operator">:</span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-ä¸Šä¼ æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_3-ä¸Šä¼ æ–‡ä»¶" aria-hidden="true">#</a> 3. ä¸Šä¼ æ–‡ä»¶</h3><p>åœ¨Resourceèµ„æºç›®å½•ä¸‹ï¼Œæ–°å»ºä¸¤ä¸ªç”¨äºæµ‹è¯•ä¸Šä¼ çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹åˆ†åˆ«å¦‚ä¸‹</p><p>æ–‡ä»¶1 <code>test.txt</code>:</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>hello ä¸€ç°ç°
å¤©æ°”ä¸é”™å“¦ğŸ˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–‡ä»¶2 <code>test2.txt</code>:</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>hello äºŒç°ç°
å¤©æ°”è¿˜å¯ä»¥å“¦ğŸ˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç®€å•è®¾ç½®ä¸€ä¸‹æ—¥å¿—æ ¼å¼ï¼Œåœ¨<code>application.yml</code>æ–‡ä»¶ä¸­</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">pattern</span><span class="token punctuation">:</span>
    <span class="token key atrule">console</span><span class="token punctuation">:</span> (%msg%n%n)<span class="token punctuation">{</span>blue<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ii-é¡¹ç›®å®ç°" tabindex="-1"><a class="header-anchor" href="#ii-é¡¹ç›®å®ç°" aria-hidden="true">#</a> II. é¡¹ç›®å®ç°</h2><p>æ–‡ä»¶ä¸Šä¼ ï¼Œä¾ç„¶æ˜¯èµ°çš„POSTè¯·æ±‚ï¼Œæ‰€ä»¥åŸºæœ¬æ“ä½œçŸ¥è¯†å’Œå‰é¢çš„POSTå·®ä¸å¤šï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºä¼ å‚</p><h3 id="_1-æ–‡ä»¶ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#_1-æ–‡ä»¶ä¸Šä¼ " aria-hidden="true">#</a> 1. æ–‡ä»¶ä¸Šä¼ </h3><p>æ–‡ä»¶ä¸Šä¼ ä¸¤ä¸ªæ ¸å¿ƒæ­¥éª¤</p><ul><li>è®¾ç½®è¯·æ±‚å¤´</li><li>ä¼ å‚ä¸ºResource</li></ul><p>æœ€åŸºç¡€çš„å•æ–‡ä»¶ä¸Šä¼ å§¿åŠ¿å®ä¾‹å¦‚ä¸‹ï¼Œä¸»è¦æ˜¯å€ŸåŠ©<code>FileSystemResource</code>æ¥è·å–æ–‡ä»¶å¹¶ä¸Šä¼ </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//è®¾ç½®è¯·æ±‚å¤´</span>
<span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
headers<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">MULTIPART_FORM_DATA</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//è®¾ç½®è¯·æ±‚ä½“ï¼Œæ³¨æ„æ˜¯LinkedMultiValueMap</span>
<span class="token class-name">FileSystemResource</span> fileSystemResource <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> form <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedMultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// postçš„æ–‡ä»¶</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> fileSystemResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// postçš„è¡¨å•å‚æ•°</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å“’å“’å“’&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//ç”¨HttpEntityå°è£…æ•´ä¸ªè¯·æ±‚æŠ¥æ–‡</span>
<span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MultiValueMap</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> files <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>form<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> ans <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8080/upload&quot;</span><span class="token punctuation">,</span> files<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;upload fileResource return: {}&quot;</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“éœ€è¦åç«¯å‘èµ·ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œä¸€èˆ¬æ¥è®²æ˜¯æ›´å¤šçš„æƒ…å†µä¸‹æ˜¯ä¸Šä¼ äºŒè¿›åˆ¶ï¼ˆoræµï¼‰ï¼Œä¸å¤ªä¼šæ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œæ‰€ä»¥æ›´å¸¸è§çš„æ˜¯<code>InputStreamResource</code>çš„ä½¿ç”¨å§¿åŠ¿</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">InputStream</span> stream <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InputStreamResource</span> inputStreamResource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamResource</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">contentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™ä¸ªæ–¹æ³•éœ€è¦é‡å†™ï¼Œå¦åˆ™æ— æ³•æ­£ç¡®ä¸Šä¼ æ–‡ä»¶ï¼›åŸå› åœ¨äºçˆ¶ç±»æ˜¯é€šè¿‡è¯»å–æµæ•°æ®æ¥è®¡ç®—å¤§å°</span>
        <span class="token keyword">return</span> stream<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> inputStreamResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
files <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>form<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
ans <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8080/upload&quot;</span><span class="token punctuation">,</span> files<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;upload streamResource return: {}&quot;</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>é‡ç‚¹æ³¨æ„</strong></p><ul><li><code>InputStreamResource</code> é‡å†™äº†<code>contentLength()</code>, <code>getFilename()</code>æ–¹æ³•ï¼Œå»æ‰è¿™ä¸ªå°±æ²¡æ³•æ­£å¸¸çš„ä¸Šä¼ æ–‡ä»¶äº†</li></ul><p>å½“ç„¶é™¤äº†<code>InputStreamResource</code>ä¹‹å¤–ï¼Œ<code>ByteArrayResource</code>ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é€‰æ‹©</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ByteArrayResource</span> byteArrayResource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayResource</span><span class="token punctuation">(</span><span class="token string">&quot;hello ä¸€ç°ç°ğŸ˜&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> byteArrayResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
files <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>form<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
ans <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8080/upload&quot;</span><span class="token punctuation">,</span> files<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;upload bytesResource return: {}&quot;</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>é‡ç‚¹æ³¨æ„</strong></p><ul><li><code>ByteArrayResource</code>é‡å†™äº†<code>getFilename()</code>æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥æµ‹è¯•ä¸€ä¸‹æ²¡æœ‰å®ƒçš„æƒ…å†µ</li></ul><h3 id="_2-å¤šæ–‡ä»¶ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#_2-å¤šæ–‡ä»¶ä¸Šä¼ " aria-hidden="true">#</a> 2. å¤šæ–‡ä»¶ä¸Šä¼ </h3><p>ä¸Šé¢ä»‹ç»çš„æ˜¯å•æ–‡ä»¶ä¸Šä¼ ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿä¼šå‡ºç°ä¸€æ¬¡ä¸Šä¼ å¤šä¸ªæ–‡ä»¶çš„æƒ…å†µï¼Œä½¿ç”¨å§¿åŠ¿å’Œå‰é¢åŸºæœ¬ä¸Šä¸€æ ·ï¼Œæ— éæ˜¯ä¼ å‚çš„æ—¶å€™å¤šä¼ ä¸¤ä¸ªè€Œå·²</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// å¤šä¸ªæ–‡ä»¶ä¸Šä¼ </span>
<span class="token class-name">FileSystemResource</span> f1 <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;test.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FileSystemResource</span> f2 <span class="token operator">=</span>
        <span class="token keyword">new</span> <span class="token class-name">FileSystemResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">&quot;test2.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> f1<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> f2<span class="token punctuation">)</span><span class="token punctuation">;</span>
form<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;å¤šä¼ &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

files <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>form<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
ans <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:8080/upload2&quot;</span><span class="token punctuation">,</span> files<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;multi upload return: {}&quot;</span><span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-è¾“å‡ºç»“æœ" tabindex="-1"><a class="header-anchor" href="#_3-è¾“å‡ºç»“æœ" aria-hidden="true">#</a> 3. è¾“å‡ºç»“æœ</h3><figure><img src="`+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="ii-å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#ii-å…¶ä»–" aria-hidden="true">#</a> II. å…¶ä»–</h2><h3 id="_0-é¡¹ç›®-ç³»åˆ—åšæ–‡" tabindex="-1"><a class="header-anchor" href="#_0-é¡¹ç›®-ç³»åˆ—åšæ–‡" aria-hidden="true">#</a> 0. é¡¹ç›®&amp;ç³»åˆ—åšæ–‡</h3><p><strong>åšæ–‡</strong></p>',39),m={href:"http://spring.hhui.top/spring-blog/2020/07/07/200707-SpringBoot%E7%B3%BB%E5%88%97AsyncRestTemplate%E4%B9%8B%E5%BC%82%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9E%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E4%BB%8B%E7%BB%8D%E7%AF%87/",target:"_blank",rel:"noopener noreferrer"},v={href:"http://spring.hhui.top/spring-blog/2020/07/05/200705-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8B%E9%9D%9E200%E7%8A%B6%E6%80%81%E7%A0%81%E4%BF%A1%E6%81%AF%E6%8D%95%E8%8E%B7/",target:"_blank",rel:"noopener noreferrer"},g={href:"http://spring.hhui.top/spring-blog/2020/07/04/200704-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8BBasic-Auth%E6%8E%88%E6%9D%83/",target:"_blank",rel:"noopener noreferrer"},b={href:"http://spring.hhui.top/spring-blog/2020/07/03/200703-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8B%E4%BB%A3%E7%90%86%E8%AE%BF%E9%97%AE/",target:"_blank",rel:"noopener noreferrer"},h={href:"http://spring.hhui.top/spring-blog/2020/07/02/200702-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8B%E8%B6%85%E6%97%B6%E8%AE%BE%E7%BD%AE/",target:"_blank",rel:"noopener noreferrer"},f={href:"http://spring.hhui.top/spring-blog/2020/07/01/200701-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8B%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98fix/",target:"_blank",rel:"noopener noreferrer"},E={href:"http://spring.hhui.top/spring-blog/2020/06/30/200630-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%A4%B4/",target:"_blank",rel:"noopener noreferrer"},B={href:"http://spring.hhui.top/spring-blog/2020/06/30/200630-SpringBoot%E7%B3%BB%E5%88%97RestTemplate%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%A4%B4/",target:"_blank",rel:"noopener noreferrer"},y=n("p",null,[n("strong",null,"æºç ")],-1),_={href:"https://github.com/liuyueyi/spring-boot-demo",target:"_blank",rel:"noopener noreferrer"},q={href:"https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/221-web-resttemplate",target:"_blank",rel:"noopener noreferrer"};function w(R,S){const a=i("ExternalLinkIcon");return e(),o("div",null,[k,c(" more "),d,n("ul",null,[n("li",null,[n("a",m,[s("ã€WEBç³»åˆ—ã€‘AsyncRestTemplateä¹‹å¼‚æ­¥éé˜»å¡ç½‘ç»œè¯·æ±‚ä»‹ç»ç¯‡"),t(a)])]),n("li",null,[n("a",v,[s("ã€WEBç³»åˆ—ã€‘RestTemplateä¹‹é200çŠ¶æ€ç ä¿¡æ¯æ•è·"),t(a)])]),n("li",null,[n("a",g,[s("ã€WEBç³»åˆ—ã€‘RestTemplateä¹‹Basic Authæˆæƒ"),t(a)])]),n("li",null,[n("a",b,[s("ã€WEBç³»åˆ—ã€‘RestTemplateä¹‹ä»£ç†è®¿é—®"),t(a)])]),n("li",null,[n("a",h,[s("ã€WEBç³»åˆ—ã€‘RestTemplateä¹‹è¶…æ—¶è®¾ç½®"),t(a)])]),n("li",null,[n("a",f,[s("ã€WEBç³»åˆ—ã€‘RestTemplateä¹‹ä¸­æ–‡ä¹±ç é—®é¢˜fix"),t(a)])]),n("li",null,[n("a",E,[s("ã€WEBç³»åˆ—ã€‘RestTemplateä¹‹è‡ªå®šä¹‰è¯·æ±‚å¤´"),t(a)])]),n("li",null,[n("a",B,[s("ã€WEBç³»åˆ—ã€‘RestTemplateåŸºç¡€ç”¨æ³•å°ç»“"),t(a)])])]),y,n("ul",null,[n("li",null,[s("å·¥ç¨‹ï¼š"),n("a",_,[s("https://github.com/liuyueyi/spring-boot-demo"),t(a)])]),n("li",null,[s("æºç : "),n("a",q,[s("https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/221-web-resttemplate"),t(a)])])])])}const A=p(r,[["render",w],["__file","200710-SpringBootç³»åˆ—RestTemplateä¹‹æ–‡ä»¶ä¸Šä¼ .html.vue"]]);export{A as default};
