import{_ as e,V as o,W as c,a1 as i,Y as n,Z as s,$ as t,X as p,F as l}from"./framework-eef79181.js";const u="/tutorial/imgs/210525/00.jpg",k="/tutorial/imgs/210525/01.jpg",r="/tutorial/imgs/210525/02.jpg",d="/tutorial/imgs/210525/03.jpg",v={},m=n("p",null,"åœ¨Javaçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¢å‘æ¥å£çš„ç¼–ç¨‹å¯èƒ½æ˜¯å¤§å®¶çš„å¸¸æ€ï¼Œåˆ‡é¢ä¹Ÿæ˜¯å„ä½å¤§ä½¬ä½¿ç”¨Springæ—¶ï¼Œæˆ–å¤šæˆ–å°‘ä¼šä½¿ç”¨çš„ä¸€é¡¹åŸºæœ¬æŠ€èƒ½ï¼›ç»“æœè¿™ä¸¤ä¸ªç¢°åˆ°ä¸€èµ·ï¼Œæœ‰æ„æ€çš„äº‹æƒ…å°±å‘ç”Ÿäº†ï¼Œæ¥å£æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ï¼Œé¢å‘æ³¨è§£çš„åˆ‡é¢æ‹¦æˆªï¼Œå±…ç„¶ä¸ç”Ÿæ•ˆ",-1),b=n("p",null,"è¿™å°±æœ‰ç‚¹å¥‡æ€ªäº†å•Šï¼Œæœ€å¼€å§‹é‡åˆ°è¿™ä¸ªé—®é¢˜æ—¶ï¼Œè¡¨ç¤ºéš¾ä»¥ç›¸ä¿¡ï¼›äº‹åŠ¡æ³¨è§£ä¹ŸæŒºå¤šæ˜¯å†™åœ¨æ¥å£ä¸Šçš„ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼ˆéš¾é“æ˜¯ä¹Ÿä¸ç”Ÿæ•ˆï¼Œåªæ˜¯è‡ªå·±æ²¡æœ‰å…³æ³¨åˆ°ï¼Ÿï¼‰",-1),g=n("p",null,"æ¥ä¸‹æ¥æˆ‘ä»¬å¥½å¥½ç…ç…ï¼Œè¿™åˆ°åº•æ˜¯æ€ä¹ˆä¸ªæƒ…å†µ",-1),h=p(`<h2 id="i-åœºæ™¯å¤ç°" tabindex="-1"><a class="header-anchor" href="#i-åœºæ™¯å¤ç°" aria-hidden="true">#</a> I. åœºæ™¯å¤ç°</h2><p>è¿™ä¸ªåœºæ™¯å¤ç°ç›¸å¯¹è€Œè¨€æ¯”è¾ƒç®€å•äº†ï¼Œä¸€ä¸ªæ¥å£ï¼Œä¸€ä¸ªå®ç°ç±»ï¼›ä¸€ä¸ªæ³¨è§£ï¼Œä¸€ä¸ªåˆ‡é¢å®Œäº‹</p><h3 id="_1-é¡¹ç›®ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#_1-é¡¹ç›®ç¯å¢ƒ" aria-hidden="true">#</a> 1. é¡¹ç›®ç¯å¢ƒ</h3><p>é‡‡ç”¨<code>SpringBoot 2.2.1.RELEASE</code> + <code>IDEA</code> + <code>maven</code> è¿›è¡Œå¼€å‘</p><p>æ·»åŠ aopä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-å¤ç°case" tabindex="-1"><a class="header-anchor" href="#_2-å¤ç°case" aria-hidden="true">#</a> 2. å¤ç°case</h3><p>å£°æ˜ä¸€ä¸ªæ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">AnoDot</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),y={href:"https://spring.hhui.top/spring-blog/2019/03/13/190313-SpringCloud%E5%BA%94%E7%94%A8%E7%AF%87%E4%B9%8BAOP%E5%AE%9E%E7%8E%B0%E6%97%A5%E5%BF%97%E5%8A%9F%E8%83%BD/",target:"_blank",rel:"noopener noreferrer"},f=p(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogAspect</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">SPLIT_SYMBOL</span> <span class="token operator">=</span> <span class="token string">&quot;|&quot;</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(public * com.git.hui.boot.aop.demo.*.*(..)) || @annotation(AnoDot)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pointcut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;pointcut()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">doAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> proceedingJoinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            req <span class="token operator">=</span> <span class="token function">buildReqLog</span><span class="token punctuation">(</span>proceedingJoinPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
            res <span class="token operator">=</span> proceedingJoinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> <span class="token string">&quot;Un-Expect-Error&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>req <span class="token operator">+</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">SPLIT_SYMBOL</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">buildReqLog</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›®æ ‡å¯¹è±¡</span>
        <span class="token class-name">Object</span> target <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ‰§è¡Œçš„æ–¹æ³•</span>
        <span class="token class-name">Method</span> method <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¯·æ±‚å‚æ•°</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">SPLIT_SYMBOL</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">SPLIT_SYMBOL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> arg <span class="token operator">:</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> builder<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">SPLIT_SYMBOL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå®šä¹‰ä¸€ä¸ªæ¥å£ä¸å®ç°ç±»ï¼Œæ³¨æ„ä¸‹é¢çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ³¨è§£åœ¨æ¥å£ä¸Šï¼Œä¸€ä¸ªæ³¨è§£åœ¨å®ç°ç±»ä¸Š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseApi</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@AnoDot</span>
    <span class="token class-name">String</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">String</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> <span class="token function">print2</span><span class="token punctuation">(</span><span class="token class-name">String</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseApiImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BaseApi</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">String</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ano in interface:&quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;return:&quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@AnoDot</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">print2</span><span class="token punctuation">(</span><span class="token class-name">String</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ano in impl:&quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;return:&quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•case</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token class-name">BaseApi</span> baseApi<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>baseApi<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-----------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>baseApi<span class="token punctuation">.</span><span class="token function">print2</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œåè¾“å‡ºç»“æœå¦‚ä¸‹ï¼ˆæœ‰å›¾æœ‰çœŸç›¸ï¼Œåˆ«è¯´æˆ‘éª—ä½ ğŸ™ƒï¼‰</p><figure><img src="`+u+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3-äº‹åŠ¡æ³¨è§£æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_3-äº‹åŠ¡æ³¨è§£æµ‹è¯•" aria-hidden="true">#</a> 3. äº‹åŠ¡æ³¨è§£æµ‹è¯•</h3><p>ä¸Šé¢è¿™ä¸ªä¸ç”Ÿæ•ˆï¼Œé‚£æˆ‘ä»¬é€šå¸¸å†™åœ¨æ¥å£ä¸Šçš„äº‹åŠ¡æ³¨è§£ï¼Œä¼šç”Ÿæ•ˆä¹ˆï¼Ÿ</p><p>æ·»åŠ mysqlæ“ä½œçš„ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•°æ®åº“é…ç½® <code>application.properties</code></p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">## DataSource</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://127.0.0.1:3306/story?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=GMT%2b8</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥å°±æ˜¯æˆ‘ä»¬çš„æ¥å£å®šä¹‰ä¸å®ç°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TransApi</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">boolean</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransApiImpl</span> <span class="token keyword">implements</span> <span class="token class-name">TransApi</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;replace into money (id, name, money) values (&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;, &#39;äº‹åŠ¡æµ‹è¯•&#39;, 200)&quot;</span><span class="token punctuation">;</span>
        jdbcTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> ans <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForMap</span><span class="token punctuation">(</span><span class="token string">&quot;select * from money where id = 111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;äº‹åŠ¡å›æ»š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ä¸Šé¢çš„updateæ–¹æ³•ï¼Œäº‹åŠ¡æ³¨è§£åœ¨æ¥å£ä¸Šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ç¡®è®¤è°ƒç”¨ä¹‹åï¼Œæ˜¯å¦ä¼šå›æ»š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token class-name">TransApiImpl</span> transApi<span class="token punctuation">,</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            transApi<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForList</span><span class="token punctuation">(</span><span class="token string">&quot;select * from money where id=111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+k+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å›æ»šäº†ï¼Œæœ‰æœ¨æœ‰ï¼ï¼ï¼</p><p>æœç„¶æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå“å¾—æˆ‘ä¸€èº«å†·æ±—ï¼Œè¿™è¦æ˜¯æœ‰é—®é¢˜ï¼Œé‚£å°±...(ä¸æ•¢æƒ³ä¸æ•¢æƒ³)</p><p>æ‰€ä»¥é—®é¢˜æ¥äº†ï¼Œä¸ºå•¥ç¬¬ä¸€ç§æ–¹å¼ä¸ç”Ÿæ•ˆå‘¢ï¼Ÿï¼Ÿï¼Ÿ</p><h2 id="ii-æ¥å£æ³¨è§£åˆ‡é¢æ‹¦æˆªå®ç°" tabindex="-1"><a class="header-anchor" href="#ii-æ¥å£æ³¨è§£åˆ‡é¢æ‹¦æˆªå®ç°" aria-hidden="true">#</a> II. æ¥å£æ³¨è§£åˆ‡é¢æ‹¦æˆªå®ç°</h2><p>æš‚ä¸”æŒ‰ä¸‹æ¢å¯»ç©¶ç«Ÿçš„æ¬²æœ›ï¼Œå…ˆçœ‹ä¸‹å¦‚æœæƒ³è®©æˆ‘ä»¬å¯ä»¥æ‹¦æˆªæ¥å£ä¸Šçš„æ³¨è§£ï¼Œå¯ä»¥æ€ä¹ˆåšå‘¢?</p><p>æ—¢ç„¶æ‹¦æˆªä¸ä¸Šï¼Œå¤šåŠæ˜¯å› ä¸ºå­ç±»æ²¡æœ‰ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œåˆ‡ç‚¹åŒ¹é…æ—¶ï¼ŒåŒ¹é…ä¸åˆ°ï¼›æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£å°±è®©å®ƒåœ¨åŒ¹é…æ—¶ï¼Œæ‰¾ä¸‹çˆ¶ç±»çœ‹æœ‰æ²¡æœ‰å¯¹åº”çš„æ³¨è§£</p><h3 id="_1-è‡ªå®šä¹‰pointcut" tabindex="-1"><a class="header-anchor" href="#_1-è‡ªå®šä¹‰pointcut" aria-hidden="true">#</a> 1. è‡ªå®šä¹‰Pointcut</h3><p>è™½è¯´æ˜¯è‡ªå®šä¹‰ï¼Œä½†ä¹Ÿæ²¡æœ‰è¦æ±‚æˆ‘ä»¬ç›´æ¥å®ç°è¿™ä¸ªæ¥å£ï¼Œæˆ‘ä»¬é€‰æ‹©<code>StaticMethodMatcherPointcut</code>æ¥è¡¥å…¨é€»è¾‘</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">AnnotatedElementUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">LogPointCut</span> <span class="token keyword">extends</span> <span class="token class-name">StaticMethodMatcherPointcut</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@SneakyThrows</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> aClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›´æ¥ä½¿ç”¨springå·¥å…·åŒ…ï¼Œæ¥è·å–methodä¸Šçš„æ³¨è§£ï¼ˆä¼šæ‰¾çˆ¶ç±»ä¸Šçš„æ³¨è§£ï¼‰</span>
        <span class="token keyword">return</span> <span class="token class-name">AnnotatedElementUtils</span><span class="token punctuation">.</span><span class="token function">hasAnnotation</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> <span class="token class-name">AnoDot</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬é‡‡ç”¨å£°æ˜å¼æ¥å®ç°åˆ‡é¢é€»è¾‘</p><h3 id="_2-è‡ªå®šä¹‰advice" tabindex="-1"><a class="header-anchor" href="#_2-è‡ªå®šä¹‰advice" aria-hidden="true">#</a> 2. è‡ªå®šä¹‰Advice</h3><p>è¿™ä¸ªadviceå°±æ˜¯æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„åˆ‡é¢é€»è¾‘ï¼Œå’Œä¸Šé¢çš„æ—¥å¿—è¾“å‡ºå·®ä¸å¤šï¼ŒåŒºåˆ«åœ¨äºå‚æ•°ä¸åŒ</p><p>è‡ªå®šä¹‰adviceå®ç°è‡ªæ¥å£<code>MethodInterceptor</code>ï¼Œé¡¶å±‚æ¥å£æ˜¯<code>Advice</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">LogAdvice</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">SPLIT_SYMBOL</span> <span class="token operator">=</span> <span class="token string">&quot;|&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">MethodInvocation</span> methodInvocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> req <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            req <span class="token operator">=</span> <span class="token function">buildReqLog</span><span class="token punctuation">(</span>methodInvocation<span class="token punctuation">)</span><span class="token punctuation">;</span>
            res <span class="token operator">=</span> methodInvocation<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> <span class="token string">&quot;Un-Expect-Error&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ExtendLogAspect:&quot;</span> <span class="token operator">+</span> req <span class="token operator">+</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">SPLIT_SYMBOL</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">buildReqLog</span><span class="token punctuation">(</span><span class="token class-name">MethodInvocation</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›®æ ‡å¯¹è±¡</span>
        <span class="token class-name">Object</span> target <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ‰§è¡Œçš„æ–¹æ³•</span>
        <span class="token class-name">Method</span> method <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¯·æ±‚å‚æ•°</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">StringBuilder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">SPLIT_SYMBOL</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">SPLIT_SYMBOL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> arg <span class="token operator">:</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            builder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> builder<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">SPLIT_SYMBOL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-è‡ªå®šä¹‰advisor" tabindex="-1"><a class="header-anchor" href="#_3-è‡ªå®šä¹‰advisor" aria-hidden="true">#</a> 3. è‡ªå®šä¹‰Advisor</h3><p>å°†ä¸Šé¢è‡ªå®šä¹‰çš„åˆ‡ç‚¹pointcutä¸é€šçŸ¥adviceæ•´åˆï¼Œå®ç°æˆ‘ä»¬çš„åˆ‡é¢</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">LogAdvisor</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractBeanFactoryPointcutAdvisor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Setter</span>
    <span class="token keyword">private</span> <span class="token class-name">Pointcut</span> logPointCut<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Pointcut</span> <span class="token function">getPointcut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> logPointCut<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-æœ€åæ³¨å†Œåˆ‡é¢" tabindex="-1"><a class="header-anchor" href="#_4-æœ€åæ³¨å†Œåˆ‡é¢" aria-hidden="true">#</a> 4. æœ€åæ³¨å†Œåˆ‡é¢</h3><p>è¯´æ˜¯æ³¨å†Œï¼Œå®é™…ä¸Šå°±æ˜¯å£°æ˜ä¸ºbeanï¼Œä¸¢åˆ°springå®¹å™¨ä¸­è€Œå·²</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">LogAdvisor</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LogAdvisor</span> logAdvisor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LogAdvisor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è‡ªå®šä¹‰å®ç°å§¿åŠ¿</span>
    logAdvisor<span class="token punctuation">.</span><span class="token function">setLogPointCut</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LogPointCut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logAdvisor<span class="token punctuation">.</span><span class="token function">setAdvice</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LogAdvice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> logAdvisor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå†æ¬¡æ‰§è¡Œä¸Šé¢çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè¾“å‡ºå¦‚ä¸‹</p><figure><img src="`+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ¥å£ä¸Šçš„æ³¨è§£ä¹Ÿè¢«æ‹¦æˆªäº†ï¼Œä½†æ˜¯æœ€åä¸€ä¸ªè€—æ—¶çš„è¾“å‡ºï¼Œæœ‰ç‚¹å¤¸å¼ äº†å•Šï¼Œé‡‡ç”¨ä¸Šé¢è¿™ç§æ–¹å¼ï¼Œè¿™ä¸ªè€—æ—¶æœ‰ç‚¹å¤¸å¼ äº†å•Šï¼Œç”Ÿäº§ç¯å¢ƒè¿™ä¹ˆä¸€æï¼Œå²‚ä¸æ˜¯åˆ†åˆ†é’Ÿå·é“ºç›–çš„èŠ‚å¥</p><ul><li>å¯ä»¥å€ŸåŠ© StopWatch æ¥æŸ¥çœ‹åˆ°åº•æ˜¯å“ªé‡Œçš„å¼€é”€å¢åŠ äº†è¿™ä¹ˆå¤š ï¼ˆå…³äºStopWatchçš„ä½¿ç”¨ï¼Œä¸‹ç¯‡ä»‹ç»ï¼‰</li><li>å•æ¬¡æ‰§è¡Œçš„ç»Ÿè®¡åå·®é—®é¢˜ï¼Œå°†ä¸Šé¢çš„è°ƒç”¨ï¼Œæ‰§è¡Œä¸€ç™¾éä¹‹åï¼Œå†çœ‹è€—æ—¶ï¼Œè¶‹äºå¹³è¡¡ï¼Œå¦‚ä¸‹å›¾</li></ul><figure><img src="'+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_5-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_5-å°ç»“" aria-hidden="true">#</a> 5. å°ç»“</h3><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å®ç°äº†æ¥å£ä¸Šæ³¨è§£çš„æ‹¦æˆªï¼Œè™½è¯´è§£å†³äº†æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä½†æ˜¯ç–‘æƒ‘çš„åœ°æ–¹ä¾ç„¶æ²¡æœ‰ç­”æ¡ˆ</p><ul><li>ä¸ºå•¥æ¥å£ä¸Šçš„æ³¨è§£æ‹¦æˆªä¸åˆ° ï¼Ÿ</li><li>ä¸ºå•¥äº‹åŠ¡æ³¨è§£ï¼Œæ”¾åœ¨æ¥å£ä¸Šå¯ä»¥ç”Ÿæ•ˆï¼Œäº‹åŠ¡æ³¨è§£çš„å®ç°æœºåˆ¶æ˜¯æ€æ ·çš„ï¼Ÿ</li><li>è‡ªå®šä¹‰çš„åˆ‡ç‚¹ï¼Œå¯ä»¥é…åˆæˆ‘ä»¬çš„æ³¨è§£æ¥ç©ä¹ˆï¼Ÿ</li><li>ä¸ºä»€ä¹ˆé¦–æ¬¡æ‰§è¡Œæ—¶ï¼Œè€—æ—¶æ¯”è¾ƒå¤šï¼›å¤šæ¬¡æ‰§è¡Œä¹‹åï¼Œåˆ™è€—æ—¶è¶‹äºæ­£å¸¸ï¼Ÿ</li></ul><p>ä¸Šé¢è¿™å‡ ä¸ªé—®é¢˜ï¼Œæ¯«æ— æ„å¤–ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰ç¡®åˆ‡çš„ç­”æ¡ˆï¼Œå¾…æˆ‘ç ”ç©¶ä¸€ç•ªï¼Œåç»­å†æ¥åˆ†äº«</p><h2 id="iii-å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#iii-å…¶ä»–" aria-hidden="true">#</a> III. å…¶ä»–</h2><h3 id="_0-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_0-é¡¹ç›®" aria-hidden="true">#</a> 0. é¡¹ç›®</h3>',49),w={href:"https://github.com/liuyueyi/spring-boot-demo",target:"_blank",rel:"noopener noreferrer"},S={href:"https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/011-aop-logaspect",target:"_blank",rel:"noopener noreferrer"},_={href:"https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/101-jdbctemplate-transaction",target:"_blank",rel:"noopener noreferrer"};function j(A,q){const a=l("ExternalLinkIcon");return o(),c("div",null,[m,b,g,i(" more "),h,n("p",null,[s("æ‹¦æˆªåˆ‡é¢ï¼Œä¸‹é¢è¿™æ®µä»£ç æ¥è‡ªä¹‹å‰åˆ†äº«çš„åšæ–‡ "),n("a",y,[s("ã€åŸºç¡€ç³»åˆ—ã€‘AOPå®ç°ä¸€ä¸ªæ—¥å¿—æ’ä»¶ï¼ˆåº”ç”¨ç¯‡ï¼‰"),t(a)])]),f,n("ul",null,[n("li",null,[s("å·¥ç¨‹ï¼š"),n("a",w,[s("https://github.com/liuyueyi/spring-boot-demo"),t(a)])]),n("li",null,[s("æ¥å£åˆ‡é¢æ‹¦æˆª: "),n("a",S,[s("https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/011-aop-logaspect"),t(a)])]),n("li",null,[s("äº‹åŠ¡: "),n("a",_,[s("https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/101-jdbctemplate-transaction"),t(a)])])])])}const I=e(v,[["render",j],["__file","05.210525-SpringBootæ¥å£æ³¨è§£åˆ‡é¢æ‹¦æˆªä¸åˆ°åœºæ™¯å…¼å®¹.html.vue"]]);export{I as default};
