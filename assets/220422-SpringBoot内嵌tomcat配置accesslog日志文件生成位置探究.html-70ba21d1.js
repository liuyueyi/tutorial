import{_ as p,V as o,W as c,a1 as i,X as n,Y as s,Z as t,a0 as e,F as l}from"./framework-23f3cf9b.js";const u="/tutorial/imgs/220422/00.jpg",r="/tutorial/imgs/220422/01.jpg",d="/tutorial/imgs/220422/02.jpg",k="/tutorial/imgs/220422/03.jpg",m="/tutorial/imgs/220422/04.jpg",v={},g=n("p",null,[s("ç°åœ¨SpringBootåº”ç”¨å¤§å¤šæ˜¯å†…åµŒtomcatï¼Œä»¥jaråŒ…æ–¹å¼å¯åŠ¨å¯¹å¤–æä¾›æœåŠ¡ï¼Œæœ€è¿‘é‡åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜ï¼Œå½“æˆ‘å¸Œæœ›è¾“å‡ºtomcatçš„ "),n("code",null,"access.log"),s(" æ—¶ï¼Œæ·»åŠ ä¸Šå¯¹åº”çš„é…ç½®ä¹‹åï¼Œå‘ç°windownsç³»ç»Ÿä¸‹æ‰¾ä¸åˆ°è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œè€Œlinux/macåˆ™æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼›")],-1),b=n("p",null,"æ‰€ä»¥èŠ±äº†äº›æ—¶é—´å®šä½ä¸€ä¸‹ï¼Œæœ¬æ–‡å°†è®°å½•å®šä½è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ç”Ÿæˆçš„å…¨è¿‡ç¨‹ï¼Œå½“å‘ç°æœ€åçš„ç»“è®ºæ—¶ï¼Œæ›´è®©æˆ‘åƒæƒŠçš„äº‹æƒ…æ¥äº†ï¼Œå°±è¿™ä¹ˆä¸ªé—®é¢˜ï¼Œåœ¨ä¸‰å¹´å‰æˆ‘ä¹Ÿé‡åˆ°è¿‡ï¼Œåªä¸è¿‡å½“æ—¶çš„é—®é¢˜æ˜¯ä¸Šä¼ æ–‡ä»¶ä¹‹åï¼Œæç¤ºä¸´æ—¶ç›®å½•ä¸å­˜åœ¨ï¼Œè€Œè¿™ä¸ªä¸´æ—¶ç›®å½•å’Œæœ¬æ–‡å®šä½çš„ç›®å½•å±…ç„¶æ˜¯ä¸€å›äº‹ï¼Œå¯è°“æ˜¯æ¥äº†ä¸€æ¬¡æ¢¦å¹»çš„è”åŠ¨ï¼Œå‰é¢è¸©çš„å‘ä¸æ¢ç©¶åˆ°åº•ï¼Œåé¢è¿Ÿæ—©ä¼šç»§ç»­æ‰å‘ğŸ˜‚",-1),h=e(`<h2 id="i-é¡¹ç›®æ­å»ºä¸æ—¥å¿—é…ç½®" tabindex="-1"><a class="header-anchor" href="#i-é¡¹ç›®æ­å»ºä¸æ—¥å¿—é…ç½®" aria-hidden="true">#</a> I. é¡¹ç›®æ­å»ºä¸æ—¥å¿—é…ç½®</h2><h3 id="_1-é¡¹ç›®ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1-é¡¹ç›®ä¾èµ–" aria-hidden="true">#</a> 1. é¡¹ç›®ä¾èµ–</h3><p>æœ¬é¡¹ç›®å€ŸåŠ©SpringBoot 2.2.1.RELEASE + maven 3.5.3 + IDEAè¿›è¡Œå¼€å‘</p><p>å¯åŠ¨ä¸€ä¸ªæ ‡å‡†çš„SpringBooté¡¹ç›®ï¼Œæ³¨æ„æ·»åŠ ä¸‹é¢çš„ä¾èµ–å¦‚ä¸‹ ï¼ˆæœ¬æ–‡å¯¹åº”çš„æºç å¯ä»¥åœ¨æ–‡æœ«æŸ¥çœ‹ï¼‰</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-tomcatæ—¥å¿—é…ç½®" tabindex="-1"><a class="header-anchor" href="#_2-tomcatæ—¥å¿—é…ç½®" aria-hidden="true">#</a> 2. tomcatæ—¥å¿—é…ç½®</h3><p>tomcatçš„æ—¥å¿—é…ç½®ä¿¡æ¯ï¼Œä¸‹é¢æ”¾åœ¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ <code>application.yml</code> ä¸­ï¼Œä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªå…³é”®å‚æ•°</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">tomcat</span><span class="token punctuation">:</span>
    <span class="token key atrule">accesslog</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">directory</span><span class="token punctuation">:</span> /tmp/logs/boot
      <span class="token key atrule">file-date-format</span><span class="token punctuation">:</span> .yyyyMMdd
      <span class="token key atrule">pattern</span><span class="token punctuation">:</span> <span class="token string">&#39;%h %l %u %t &quot;%r&quot; %s %b %Dms &quot;%{Referer}i&quot; &quot;%{User-Agent}i&quot; &quot;%{X-Request-ID}i&quot; &quot;%{X-Forwarded-For}i&quot;&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-ä¸€ä¸ªç®€å•çš„restæ¥å£" tabindex="-1"><a class="header-anchor" href="#_3-ä¸€ä¸ªç®€å•çš„restæ¥å£" aria-hidden="true">#</a> 3. ä¸€ä¸ªç®€å•çš„restæ¥å£</h3><p>æ·»åŠ ä¸€ä¸ªåŸºç¡€çš„restæ¥å£ï¼Œç”¨äºæ¥æ”¶è¯·æ±‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">DalConfig</span> dalConfig<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token class-name">DalConfig</span> dalConfig<span class="token punctuation">,</span> <span class="token class-name">Environment</span> environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dalConfig <span class="token operator">=</span> dalConfig<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dalConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span> application <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        application<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/index&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥è¯·æ±‚ä¸€ä¸‹æ¥å£ï¼Œçœ‹ä¸‹æ—¥å¿—æ˜¯å¦æ­£å¸¸</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token string">&#39;http://127.0.0.1:8080/&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæ˜¯mac/linuxç³»ç»Ÿçš„åŒå­¦ï¼Œå°±å¯ä»¥åˆ° <code>/tmp/logs/boot</code> ç›®å½•ä¸‹æŸ¥çœ‹æœ‰æ²¡æœ‰å¯¹åº”çš„æ—¥å¿—æ–‡ä»¶äº†ï¼Œé‚£ä¹ˆwinçš„åŒå­¦ï¼Œåˆ°å“ªé‡Œçœ‹ï¼Ÿ</p><h2 id="ii-æ—¥å¿—æ–‡ä»¶ç›®å½•å®šä½" tabindex="-1"><a class="header-anchor" href="#ii-æ—¥å¿—æ–‡ä»¶ç›®å½•å®šä½" aria-hidden="true">#</a> II. æ—¥å¿—æ–‡ä»¶ç›®å½•å®šä½</h2><p>ç”±äºwinå’Œmac/linuxå¯¹ç»å¯¹è·¯å¾„çš„å®šä¹‰ä¸åŒï¼Œå°±ä¼šå¯¼è‡´æˆ‘ä»¬ç”¨åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå®é™…çš„é¡¹ç›®æœ€ç»ˆéƒ½æ˜¯è·‘åœ¨linuxç³»ç»Ÿä¸Šï¼Œæ‰€ä»¥æ–‡ä»¶è·¯å¾„ä»¥ä¸Šé¢çš„caseå±…å¤šï¼Œå¾ˆå°‘ä¼šè¯´åŠ ä¸€ä¸ª <code>c:</code>ï¼Œ<code>d:</code>å¼€å¤´çš„</p><p>é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼ŒåŒæ ·ä¸€ä»½ä»£ç ï¼Œwinå¼€å‘çš„åŒå­¦åˆ°å“ªé‡Œå»æ‰¾æ—¥å¿—</p><h3 id="_1-æºç å®šä½" tabindex="-1"><a class="header-anchor" href="#_1-æºç å®šä½" aria-hidden="true">#</a> 1. æºç å®šä½</h3><p>æˆ‘ä»¬è¿™é‡Œè®¨è®ºçš„æ˜¯å†…åµŒTomcatï¼Œè¦æƒ³å®šä½æ—¥å¿—æ–‡ä»¶åœ¨å“ªé‡Œï¼Œå°±éœ€è¦å…ˆæ‰¾ä¸€ä¸‹è¿™ä¸ªæ—¥å¿—å“ªé‡Œè¾“å‡ºçš„ï¼Œ</p><p>ç›´æ¥googleæœç´¢ä¸€ä¸‹å…³é”®å­—ï¼Œå°±å¯ä»¥å¾—åˆ°æœ‰ç”¨çš„ä¿¡æ¯</p><figure><img src="`+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸Šé¢çš„ç¬¬ä¸€é¡¹ï¼Œç»™å‡ºäº†ä¸€ä¸ªæ ¸å¿ƒçš„ç±» <code>AccessLogValve</code>ï¼Œä¸€ä¸‹å­å°±æ‰¾åˆ°å…³é”®ç‚¹äº†ï¼Œæ ¸å¿ƒåœ°æ–¹æ‰“ä¸ªç«¯ç‚¹ï¼Œå¯åŠ¨ä¸€ä¸‹çœ‹çœ‹æ˜¯æ€æ ·çš„</p><figure><img src="'+r+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸Šé¢è¿™ä¸ªåœ°å€å°±æ˜¯æˆ‘ä»¬æ‰¾çš„ç›®æ ‡è·¯å¾„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿè¿™ä¸ªå‰ç¼€æœ‰ä»€ä¹ˆå¥—è·¯ä¹ˆï¼Ÿ</p><p>æ ¸å¿ƒæ¥æºç‚¹ <code>File dir = this.getDirectoryFile();</code>ï¼Œå¯¹åº”çš„å®ç°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token class-name">File</span> <span class="token function">getDirectoryFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™ä¸ªdirectoryå°±æ˜¯æˆ‘ä»¬å¯¹åº”çš„é…ç½®å‚æ•° server.tomcat.access_log.directory</span>
        <span class="token class-name">File</span> dir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dir<span class="token punctuation">.</span><span class="token function">isAbsolute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            dir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCatalinaBase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> dir<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰€ä»¥é‡ç‚¹éœ€è¦å…³æ³¨ <code>this.getContainer().getCatalinaBase()</code>ï¼Œ ä¸Šé¢è¿™ä¸ªå®ƒå¯¹åº”çš„å®ä¾‹ä¸º<code>org.apache.catalina.core.StandardEngine#getCatalinaBase</code></p><p>æ¥ç€å‘ä¸Šæœ”æºï¼Œå¯ä»¥æ‰¾åˆ°è®¾ç½®è¿™ä¸ªè·¯å¾„çš„åœ°æ–¹ï¼Œåœ¨<code>org.apache.catalina.startup.Tomcat#initBaseDir</code></p><figure><img src="`+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æœ€åå°±æ˜¯å®šä½baseDirçš„åˆå§‹åŒ–äº†ï¼Œå†ç½‘ä¸Šæ‰¾ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å…³é”®ä¿¡æ¯</p><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å†ç›´è¾¾ä¸€æ­¥ï¼ŒåŸæ¥è¿™ä¸ªç›®å½•åˆ›å»ºæ˜¯åŸºäº <code>jdk</code>çš„<code>File.createTempFile()</code>æ¥å®ç°çš„ï¼Œåˆå­¦åˆ°ä¸€ä¸ªæ²¡ä»€ä¹ˆé¸Ÿç”¨çš„çŸ¥è¯†ç‚¹äº†</p><figure><img src="'+m+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_2-å°ç»“" aria-hidden="true">#</a> 2. å°ç»“</h3><p>æœ¬æ–‡å¯èƒ½å¯¹å¤§éƒ¨åˆ†å°ä¼™ä¼´æ¥è¯´æ²¡ä»€ä¹ˆé¸Ÿç”¨ï¼ŒåŸºæœ¬ä¸Šä¹Ÿä¸å¤ªä¼šæœ‰ç”¨åˆ°éœ€è¦å–æŸ¥æ‰¾tomcatçš„è®¿é—®æ—¥å¿—<code>access.log</code>çš„æ—¶å€™ï¼ˆè¿™é‡ŒæŒ‡SpringBootåº”ç”¨ï¼‰ï¼Œåœ¨å®šä½è¿™ä¸ªå…·ä½“è·¯å¾„çš„æ—¶å€™ï¼Œæƒ³èµ·äº†å¾ˆä¹…ä¹‹å‰ä¹Ÿè¸©è¿‡çš„ä¸€ä¸ªå‘ï¼Œä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œæç¤ºä¸´æ—¶ç›®å½•ä¸å­˜åœ¨ï¼Œè€Œè¿™ä¸ªç›®å½•å’Œæˆ‘ä»¬ä¸Šé¢æŸ¥æ‰¾å®šä½çš„å¯ä»¥è¯´æ˜¯ä¸€ä¸ªåœ°æ–¹äº†ï¼Œä»”ç»†çœ‹æ¥ï¼Œç°åœ¨ç®—æ˜¯å¡«äº†ä¸€ä¸ªæ—¶éš”ä¸‰å¹´çš„å‘äº†ğŸ˜</p>',35),y={href:"https://spring.hhui.top/spring-blog/2019/02/13/190213-SpringBoot%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%BC%82%E5%B8%B8%E4%B9%8B%E6%8F%90%E7%A4%BAThe-temporary-upload-location-xxx-is-not-valid/",target:"_blank",rel:"noopener noreferrer"},f=e(`<p>æœ€åå°ç»“ä¸‹æœ¬æ–‡å¯¹åº”çš„çŸ¥è¯†ç‚¹</p><p><strong>tip1 accesslogæ—¥å¿—é…ç½®</strong></p><p>æ ¸å¿ƒé…ç½®ä¿¡æ¯å¦‚ä¸‹</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">tomcat</span><span class="token punctuation">:</span>
    <span class="token key atrule">accesslog</span><span class="token punctuation">:</span>
      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºè¾“å‡º accesslog æ—¥å¿—</span>
      <span class="token key atrule">directory</span><span class="token punctuation">:</span> /logs/boot  <span class="token comment"># æ—¥å¿—æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œæ³¨æ„ä¸åŒæ“ä½œç³»ç»Ÿï¼Œå¯¹ç»å¯¹è·¯å¾„çš„å®šä½ä¸åŒ</span>
      <span class="token key atrule">file-date-format</span><span class="token punctuation">:</span> .yyyyMMdd <span class="token comment"># æŒ‰æ—¥æœŸè¿›è¡Œå½’æ¡£</span>
      <span class="token key atrule">pattern</span><span class="token punctuation">:</span> <span class="token string">&#39;%h %l %u %t &quot;%r&quot; %s %b %Dms &quot;%{Referer}i&quot; &quot;%{User-Agent}i&quot; &quot;%{X-Request-ID}i&quot; &quot;%{X-Forwarded-For}i&quot;&#39;</span> <span class="token comment"># æ—¥å¿—è¾“å‡ºæ ¼å¼ï¼Œç±»ä¼¼Logbacké…ç½®</span>
<span class="token comment">#    basedir: /logs  # å…¨å±€åŸºæœ¬ç›®å½•ï¼Œå¦‚æœé…ç½®ï¼Œåˆ™æ—¥å¿—æ–‡ä»¶å¯¹åº”çš„ç›®å½•ä¸º basedir + directory</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>tip2 ç»å¯¹è·¯å¾„çš„åˆ¤æ–­</strong></p><p>åœ¨Tomcatä¸­ï¼Œå¯¹äºç»å¯¹è·¯å¾„çš„åˆ¤æ–­éå¸¸æœ‰å‚è€ƒä»·å€¼ï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºæˆ‘å¯¹äºjdkåŸºæœ¬çš„apiä¸å¤Ÿç†Ÿæ‚‰çš„åŸå›  ï¼Œä¹‹å‰æˆ‘çš„åˆ¤æ–­æ–¹å¼æ˜¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * æ˜¯å¦windowsç³»ç»Ÿ
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isWinOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> isWinOS <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> osName <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;os.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> sharpOsName <span class="token operator">=</span> osName<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;windows&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{windows}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;^win([^a-z])&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{windows}$1&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;([^a-z])win([^a-z])&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;$1{windows}$2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        isWinOS <span class="token operator">=</span> sharpOsName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;{windows}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> isWinOS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isAbsFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isWinOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// windows æ“ä½œç³»ç»Ÿæ—¶ï¼Œç»å¯¹åœ°å€å½¢å¦‚  c:\\descktop</span>
        <span class="token keyword">return</span> fileName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> fileName<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;\\\\&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// mac or linux</span>
        <span class="token keyword">return</span> fileName<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨åˆ™æœ‰æ›´ç®€å•çš„æ–¹å¼äº†</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isAbs</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isAbsolute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>tip3 ä¸´æ—¶ç›®å½•åˆ›å»º</strong></p><p>åŒæ ·æ˜¯ç›´æ¥å€ŸåŠ©Fileæ¥å®ç°ï¼Œ <code>File.createTempFile</code> å³å¯ï¼Œä¸‹é¢æ˜¯Tomcatçš„åˆ›å»ºæ–¹å¼ï¼Œè¿˜éå¸¸è´´å¿ƒçš„åŠ ä¸Šäº†è™šæ‹Ÿæœºç»ˆæ­¢æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤ç›¸å…³çš„æ–‡ä»¶</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Return the absolute temp dir for given web server.
 * <span class="token keyword">@param</span> <span class="token parameter">prefix</span> server name
 * <span class="token keyword">@return</span> the temp dir for given server.
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">File</span> <span class="token function">createTempDir</span><span class="token punctuation">(</span><span class="token class-name">String</span> prefix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">File</span> tempDir <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">.</span><span class="token function">createTempFile</span><span class="token punctuation">(</span>prefix <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tempDir<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tempDir<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tempDir<span class="token punctuation">.</span><span class="token function">deleteOnExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tempDir<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">WebServerException</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Unable to create tempDir. java.io.tmpdir is set to &quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;java.io.tmpdir&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="iii-ä¸èƒ½é”™è¿‡çš„æºç å’Œç›¸å…³çŸ¥è¯†ç‚¹" tabindex="-1"><a class="header-anchor" href="#iii-ä¸èƒ½é”™è¿‡çš„æºç å’Œç›¸å…³çŸ¥è¯†ç‚¹" aria-hidden="true">#</a> III. ä¸èƒ½é”™è¿‡çš„æºç å’Œç›¸å…³çŸ¥è¯†ç‚¹</h2><h3 id="_0-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_0-é¡¹ç›®" aria-hidden="true">#</a> 0. é¡¹ç›®</h3>`,14),_={href:"https://github.com/liuyueyi/spring-boot-demo",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/001-properties-env-mvn",target:"_blank",rel:"noopener noreferrer"},q=n("h3",{id:"_1-å¾®ä¿¡å…¬ä¼—å·-ä¸€ç°ç°blog",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-å¾®ä¿¡å…¬ä¼—å·-ä¸€ç°ç°blog","aria-hidden":"true"},"#"),s(" 1. å¾®ä¿¡å…¬ä¼—å·: ä¸€ç°ç°Blog")],-1),x=n("p",null,"å°½ä¿¡ä¹¦åˆ™ä¸å¦‚ï¼Œä»¥ä¸Šå†…å®¹ï¼Œçº¯å±ä¸€å®¶ä¹‹è¨€ï¼Œå› ä¸ªäººèƒ½åŠ›æœ‰é™ï¼Œéš¾å…æœ‰ç–æ¼å’Œé”™è¯¯ä¹‹å¤„ï¼Œå¦‚å‘ç°bugæˆ–è€…æœ‰æ›´å¥½çš„å»ºè®®ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ï¼Œä¸åæ„Ÿæ¿€",-1),B=n("p",null,"ä¸‹é¢ä¸€ç°ç°çš„ä¸ªäººåšå®¢ï¼Œè®°å½•æ‰€æœ‰å­¦ä¹ å’Œå·¥ä½œä¸­çš„åšæ–‡ï¼Œæ¬¢è¿å¤§å®¶å‰å»é€›é€›",-1),S={href:"https://blog.hhui.top",target:"_blank",rel:"noopener noreferrer"},j={href:"http://spring.hhui.top",target:"_blank",rel:"noopener noreferrer"},F=n("figure",null,[n("img",{src:"https://spring.hhui.top/spring-blog/imgs/info/info.png",alt:"ä¸€ç°ç°blog",tabindex:"0",loading:"lazy"}),n("figcaption",null,"ä¸€ç°ç°blog")],-1);function A(E,C){const a=l("ExternalLinkIcon");return o(),c("div",null,[g,b,i(" more "),h,n("blockquote",null,[n("ul",null,[n("li",null,[n("a",y,[s("ã€WEBç³»åˆ—ã€‘SpringBootæ–‡ä»¶ä¸Šä¼ å¼‚å¸¸ä¹‹æç¤ºThe temporary upload location xxx is not validï¼ˆå¡«å‘ç¯‡ï¼‰ | ä¸€ç°ç°Blog"),t(a)])])])]),f,n("ul",null,[n("li",null,[s("å·¥ç¨‹ï¼š"),n("a",_,[s("https://github.com/liuyueyi/spring-boot-demo"),t(a)])]),n("li",null,[s("æºç ï¼š"),n("a",w,[s("https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/001-properties-env-mvn"),t(a)])])]),q,x,B,n("ul",null,[n("li",null,[s("ä¸€ç°ç°Blogä¸ªäººåšå®¢ "),n("a",S,[s("https://blog.hhui.top"),t(a)])]),n("li",null,[s("ä¸€ç°ç°Blog-Springä¸“é¢˜åšå®¢ "),n("a",j,[s("http://spring.hhui.top"),t(a)])])]),F])}const I=p(v,[["render",A],["__file","220422-SpringBootå†…åµŒtomcaté…ç½®accesslogæ—¥å¿—æ–‡ä»¶ç”Ÿæˆä½ç½®æ¢ç©¶.html.vue"]]);export{I as default};
