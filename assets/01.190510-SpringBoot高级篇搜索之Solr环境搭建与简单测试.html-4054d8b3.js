import{_ as e,V as o,W as c,a1 as l,X as n,Y as s,Z as t,a0 as p,F as i}from"./framework-23f3cf9b.js";const u="/tutorial/imgs/190510/00.jpg",r="/tutorial/imgs/190510/01.jpg",k="/tutorial/imgs/190510/02.jpg",d="/tutorial/imgs/190510/03.jpg",g="/tutorial/imgs/190510/04.jpg",m="/tutorial/imgs/190510/05.jpg",v="/tutorial/imgs/190510/06.jpg",b="/tutorial/imgs/190510/07.jpg",h="/tutorial/imgs/190510/08.jpg",f="/tutorial/imgs/190510/09.jpg",y={},_=n("p",null,"搜索可以说是非常常见的场景了，一般选择比较多的有solr和es，底层都是基于Lucene搜索引擎实现。之前简单的使用过solr，一直没有成体系的学习过，正好需要给一个内部项目封装统一的查询组件，借这个机会好好的撸一把solr的知识要点",-1),w=p(`<h2 id="i-solr环境搭建" tabindex="-1"><a class="header-anchor" href="#i-solr环境搭建" aria-hidden="true">#</a> I. Solr环境搭建</h2><h3 id="_1-docker方式安装solr" tabindex="-1"><a class="header-anchor" href="#_1-docker方式安装solr" aria-hidden="true">#</a> 1. docker方式安装solr</h3><p>使用docker实现solr环境的搭建，快速简洁</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> pull solr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>启动solr容器</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> my-solr <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8983</span>:8983 <span class="token parameter variable">-t</span> solr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6),x={href:"http://localhost:8983/solr/#/",target:"_blank",rel:"noopener noreferrer"},S=p(`<p><strong>新建core</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>solr my-solr bin/solr create_core <span class="token parameter variable">-c</span> yhh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>建立成功之后，终端会有相应的提示，然后刷新浏览器，可以看到新的yhh</p><figure><img src="`+u+`" alt="控制台" tabindex="0" loading="lazy"><figcaption>控制台</figcaption></figure><h3 id="_2-schema" tabindex="-1"><a class="header-anchor" href="#_2-schema" aria-hidden="true">#</a> 2. schema</h3><p>通过docker安装的最新solr版本为8.0，可以直接在http界面通过控制台来创建schema，而不需要像以前那样，进入配置文件进行添加处理；当然也可以通过修改对应的配置</p><p>假定我们现在需要在yhh这个core中存文章，结构为</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>id: string # 默认的全局唯一字段
title: string # 文章标题
content: string # 文章内容
type: int # 文章类型
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="a-控制台添加方式" tabindex="-1"><a class="header-anchor" href="#a-控制台添加方式" aria-hidden="true">#</a> a. 控制台添加方式</h4>`,9),q={href:"http://localhost:8983/solr/#/yhh/schema",target:"_blank",rel:"noopener noreferrer"},j=p('<figure><img src="'+r+'" alt="1" tabindex="0" loading="lazy"><figcaption>1</figcaption></figure><p>然后通过点击Add Field按钮添加字段，确认按钮之后完成添加</p><figure><img src="'+k+'" alt="2" tabindex="0" loading="lazy"><figcaption>2</figcaption></figure><p>添加完成之后点击<code>please select...</code>，弹出下拉框，看到刚才添加的东西</p><figure><img src="'+d+`" alt="3" tabindex="0" loading="lazy"><figcaption>3</figcaption></figure><h4 id="b-编辑xml文件方式" tabindex="-1"><a class="header-anchor" href="#b-编辑xml文件方式" aria-hidden="true">#</a> b. 编辑xml文件方式</h4><p>通过控制台的overiew可以定位到core存储路径，然后我们找到对应的定义文件，添加两个字段</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>create_at: long # 文章创建时间
publish_at: long # 文章发布时间
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>修改配置文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 首先进入docker内</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>root my-solr /bin/bash

<span class="token comment"># 定位配置文件</span>
<span class="token function">vim</span> /var/solr/data/yhh/conf/managed-schema

<span class="token comment"># 新增字段</span>
<span class="token operator">&lt;</span>field <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;create_at&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;pint&quot;</span> <span class="token assign-left variable">uninvertible</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> <span class="token assign-left variable">default</span><span class="token operator">=</span><span class="token string">&quot;0&quot;</span> <span class="token assign-left variable">indexed</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> <span class="token assign-left variable">stored</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> /<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;publish_at&quot;</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">&quot;pint&quot;</span> <span class="token assign-left variable">uninvertible</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> <span class="token assign-left variable">default</span><span class="token operator">=</span><span class="token string">&quot;0&quot;</span> <span class="token assign-left variable">indexed</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> <span class="token assign-left variable">stored</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span> /<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改完成之后如下图</p><figure><img src="`+g+'" alt="xml" tabindex="0" loading="lazy"><figcaption>xml</figcaption></figure><p>配置文件修改之后，再去刷控制台，发现并没有显示出来，通过重启solr之后，新的才显示出来</p><figure><img src="'+m+'" alt="show" tabindex="0" loading="lazy"><figcaption>show</figcaption></figure><h4 id="c-功能测试" tabindex="-1"><a class="header-anchor" href="#c-功能测试" aria-hidden="true">#</a> c. 功能测试</h4><p>schema定义完毕之后，就可以进行简单的测试了，先加几个文档；然后再进行查询</p><p><strong>添加文档</strong></p>',17),I={href:"http://localhost:8983/solr/#/yhh/documents",target:"_blank",rel:"noopener noreferrer"},C=p(`<div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
title<span class="token operator">:</span> <span class="token string">&quot;一灰灰&quot;</span><span class="token punctuation">,</span>
content<span class="token operator">:</span> <span class="token string">&quot;欢迎来到一灰灰的博客&quot;</span><span class="token punctuation">,</span>
type<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
create_at<span class="token operator">:</span> <span class="token number">1557488164</span><span class="token punctuation">,</span>
publish_at<span class="token operator">:</span> <span class="token number">1557488164</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+v+'" alt="添加文档" tabindex="0" loading="lazy"><figcaption>添加文档</figcaption></figure><p><strong>文档查询</strong></p>',3),B={href:"http://localhost:8983/solr/#/yhh/query",target:"_blank",rel:"noopener noreferrer"},A=p('<figure><img src="'+b+'" alt="文档查询" tabindex="0" loading="lazy"><figcaption>文档查询</figcaption></figure><p>然后来个高级一点的查询，我希望查询所有内容包含一灰灰的数据，可以如下查询</p><figure><img src="'+h+`" alt="文档查询" tabindex="0" loading="lazy"><figcaption>文档查询</figcaption></figure><h2 id="ii-springboot搭建solr环境" tabindex="-1"><a class="header-anchor" href="#ii-springboot搭建solr环境" aria-hidden="true">#</a> II. SpringBoot搭建solr环境</h2><h3 id="_1-配置" tabindex="-1"><a class="header-anchor" href="#_1-配置" aria-hidden="true">#</a> 1. 配置</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.4.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- lookup parent from update --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.reporting.outputEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.reporting.outputEncoding</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-cloud.version</span><span class="token punctuation">&gt;</span></span>Finchley.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-cloud.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginManagement</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginManagement</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repositories</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>spring-milestones<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>Spring Milestones<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>https://repo.spring.io/milestone<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repositories</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-solr<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的配置中，需要注意是引入包 <code>spring-boot-starter-data-solr</code></p><p>引入这个包之后，我们就可以愉快的使用<code>SolrTemplate</code>来完成solr的各种骚操作了</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>git<span class="token punctuation">.</span>hui<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>client<span class="token punctuation">.</span>solrj<span class="token punctuation">.</span></span><span class="token class-name">SolrClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>condition<span class="token punctuation">.</span></span><span class="token class-name">ConditionalOnMissingBean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">SolrTemplate</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Created by @author yihui in 19:49 19/5/10.
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SearchAutoConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">SolrTemplate</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">SolrTemplate</span> <span class="token function">solrTemplate</span><span class="token punctuation">(</span><span class="token class-name">SolrClient</span> solrClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SolrTemplate</span><span class="token punctuation">(</span>solrClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-简单测试" tabindex="-1"><a class="header-anchor" href="#_2-简单测试" aria-hidden="true">#</a> 2. 简单测试</h3><p>下面搞一个简单的查询，看下能不能获取到solr文档</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>git<span class="token punctuation">.</span>hui<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>solr</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">SolrTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>


<span class="token doc-comment comment">/**
 * Created by @author yihui in 19:45 19/5/10.
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SolrSearchService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">SolrTemplate</span> solrTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Data</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">DocDO</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Integer</span> type<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> create_at<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> publish_at<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DocDO</span> ans <span class="token operator">=</span> solrTemplate<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token string">&quot;yhh&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">DocDO</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-测试" tabindex="-1"><a class="header-anchor" href="#_3-测试" aria-hidden="true">#</a> 3. 测试</h3><p>启动下任务开始测试</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>git<span class="token punctuation">.</span>hui<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>solr</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>git<span class="token punctuation">.</span>hui<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>solr<span class="token punctuation">.</span>solr<span class="token punctuation">.</span></span><span class="token class-name">SolrSearchService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Created by @author yihui in 19:44 19/5/10.
 */</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">SolrSearchService</span> solrSearchService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token class-name">SolrSearchService</span> solrSearchService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>solrSearchService <span class="token operator">=</span> solrSearchService<span class="token punctuation">;</span>
        <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>solrSearchService<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行截图如下</p><figure><img src="`+f+'" alt="测试输出" tabindex="0" loading="lazy"><figcaption>测试输出</figcaption></figure><h2 id="iii-小结" tabindex="-1"><a class="header-anchor" href="#iii-小结" aria-hidden="true">#</a> III. 小结</h2><p>上面介绍了最基础的solr环境搭建，springboot的solr测试环境准备，并实现了一个简单的查询实例，但距离真正上手撸solr还缺不少东西</p><ul><li>solr的基础知识，前面的字段定义是否合法，索引什么的改怎么考虑</li><li>配置修改，安全保证</li><li>中文分词如何设置，如何使用在solr中进行使用</li><li>solr的增删改查的基本操作姿势</li><li>solr的全文搜索优势如何体现</li><li>SpringBoot中进行solr操作</li><li>...</li></ul><h3 id="_0-项目" tabindex="-1"><a class="header-anchor" href="#_0-项目" aria-hidden="true">#</a> 0. 项目</h3>',21),E={href:"https://github.com/liuyueyi/spring-boot-demo",target:"_blank",rel:"noopener noreferrer"},T={href:"https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/140-search-solr",target:"_blank",rel:"noopener noreferrer"};function z(D,L){const a=i("ExternalLinkIcon");return o(),c("div",null,[_,l(" more "),w,n("p",null,[s("浏览器打开: "),n("a",x,[s("http://localhost:8983/solr/#/"),t(a)])]),S,n("p",null,[s("首先进入schema的页面，可以如下操作，也可以点击连接: "),n("a",q,[s("http://localhost:8983/solr/#/yhh/schema"),t(a)])]),j,n("p",null,[s("直接在控制台进行添加: "),n("a",I,[s("http://localhost:8983/solr/#/yhh/documents"),t(a)])]),C,n("p",null,[s("直接在控制台进行操作："),n("a",B,[s("http://localhost:8983/solr/#/yhh/query"),t(a)])]),A,n("ul",null,[n("li",null,[s("工程："),n("a",E,[s("https://github.com/liuyueyi/spring-boot-demo"),t(a)])]),n("li",null,[s("项目： "),n("a",T,[s("https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/140-search-solr"),t(a)])])])])}const F=e(y,[["render",z],["__file","01.190510-SpringBoot高级篇搜索之Solr环境搭建与简单测试.html.vue"]]);export{F as default};
