import{_ as o,V as p,W as c,a1 as i,Y as n,a0 as a,Z as e,X as t,F as l}from"./framework-ad59245f.js";const u="/tutorial/imgs/200317/00.jpg",r={},d=n("p",null,"åœ¨æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œç»å¤§å¤šæ•°æˆ‘ä»¬éƒ½æ˜¯ä¸å…³æ³¨beançš„åŠ è½½é¡ºåºï¼Œç„¶è€Œå¦‚æœåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå½“æˆ‘ä»¬å¸Œæœ›æŸä¸ªbeanä¼˜äºå…¶ä»–çš„beanè¢«å®ä¾‹åŒ–æ—¶ï¼Œå¾€å¾€å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡ä¸­çš„é‚£ä¹ˆç®€å•",-1),k=t(`<h2 id="i-å¯åŠ¨ç±»æŒ‡å®šæ–¹å¼" tabindex="-1"><a class="header-anchor" href="#i-å¯åŠ¨ç±»æŒ‡å®šæ–¹å¼" aria-hidden="true">#</a> I. å¯åŠ¨ç±»æŒ‡å®šæ–¹å¼</h2><p>åœ¨å®é™…çš„SpringBootå¼€å‘ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“éƒ½ä¼šæœ‰ä¸€ä¸ªå¯åŠ¨ç±»ï¼Œå¦‚æœå¸Œæœ›æŸä¸ªç±»è¢«ä¼˜å…ˆåŠ è½½ï¼Œä¸€ä¸ªæˆæœ¬æœ€ä½çš„ç®€å•å®ç°ï¼Œå°±æ˜¯åœ¨å¯åŠ¨ç±»é‡Œæ·»åŠ ä¸Šä¾èµ–</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token class-name">DemoBean</span> demoBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        demoBean<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ä¸Šé¢çš„æ„é€ æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨åº”ç”¨å¯åŠ¨ä¹‹å‰ï¼Œ<code>demoBean</code>å°±å·²ç»è¢«åŠ è½½äº†ï¼Œé‚£å°±è®©Applicationå¼ºåˆ¶ä¾èµ–å®ƒï¼Œæ‰€ä»¥å†Applicationçš„beanåˆå§‹åŒ–ä¹‹å‰ï¼Œè‚¯å®šä¼šä¼˜å…ˆå®ä¾‹åŒ–<code>demoBean</code></p><p>ç›¸ä¿¡ä¸Šé¢è¿™ç§å†™æ³•ï¼Œå¤§å®¶å¹¶ä¸ä¼šé™Œç”Ÿï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬åº”ç”¨å¯åŠ¨ä¹‹åï¼Œå‘ç°æŸä¸ªä¾èµ–çš„beanï¼ˆä¸€èˆ¬æ¥è®²æ˜¯ç¬¬ä¸‰æ–¹åº“æä¾›çš„beanï¼‰è¿˜æ²¡æœ‰åˆå§‹åŒ–å¯¼è‡´npeæ—¶ï¼Œç”¨è¿™ç§æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒå¤šçš„</p><p><strong>case1</strong></p><p>æˆ‘ä»¬ä¸”ä¸è°ˆè¿™ç§å®ç°æ–¹å¼æ˜¯å¦ä¼˜é›…ï¼Œå½“æˆ‘ä»¬å¸Œæœ›<code>targetBean</code>åœ¨æ‰€æœ‰çš„beanå®ä¾‹åŒ–ä¹‹å‰è¢«å®ä¾‹æ—¶ï¼Œä¸Šé¢è¿™ç§å†™æ³•æ˜¯å¦ä¸€å®šä¼šç”Ÿæ•ˆå‘¢ï¼Ÿ</p><p><strong>case2</strong></p><p>ä¸­é—´ä»¶åŒå­¦ï¼šå­å“§å­å“§çš„å¼€å‘äº†ä¸€ä¸ªğŸ‚ğŸºjaråŒ…ï¼Œåªè¦æ¥å…¥äº†ä¿è¯ä½ çš„åº”ç”¨æ°¸è¿œä¸ä¼šå®•æœºï¼ˆè¯·æ— è§†å¤¸å¼ çš„è¨€è¯­ï¼‰,å”¯ä¸€çš„è¦æ±‚æ˜¯æ¥å…¥æ—¶ï¼Œéœ€è¦ä¼˜å…ˆåŠ è½½jaråŒ…é‡Œé¢çš„<code>firstBean</code>...</p><p>æ¥å…¥æ–¹ï¼šä½ çš„beanè¦æ±‚è¢«é¦–å…ˆåŠ è½½è¿™ä¸ªå¾—ä½ è‡ªå·±ä¿è¯å•Šï¼Œæˆ‘å†™äº›if/elseä»£ç å·²ç»å¾ˆè¾›è‹¦äº†ï¼Œå“ªæœ‰ç²¾åŠ›ä¿è¯ä½ çš„è¿™ä¸ªä¼˜å…ˆåŠ è½½ï¼ï¼ï¼ä½ è‡ªå·±éƒ½æ²¡æ³•ä¿è¯ï¼Œé‚£æˆ‘ä¹Ÿæ²¡åŠæ³•ä¿è¯...</p><p>ä¸­é—´ä»¶åŒå­¦ï¼šè¿˜èƒ½ä¸èƒ½æ„‰å¿«çš„ç©è€äº†....</p><h2 id="ii-instantiationawarebeanpostprocessoradapteræ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ii-instantiationawarebeanpostprocessoradapteræ–¹å¼" aria-hidden="true">#</a> II. <code>InstantiationAwareBeanPostProcessorAdapter</code>æ–¹å¼</h2>`,12),v={href:"http://spring.hhui.top/spring-blog/2019/10/29/191029-SpringBoot%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B%E4%B9%8BBean%E4%B9%8B%E6%8C%87%E5%AE%9A%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%BA%E5%BA%8F%E7%9A%84%E8%8B%A5%E5%B9%B2%E5%A7%BF%E5%8A%BF/",target:"_blank",rel:"noopener noreferrer"},m=t(`<p>æ¥ä¸‹æ¥ä»‹ç»å¦å¤–ä¸€ç§ä½¿ç”¨å§¿åŠ¿ï¼Œå€ŸåŠ©<code>InstantiationAwareBeanPostProcessorAdapter</code>æ¥å®ç°åœ¨beanå®ä¾‹åŒ–ä¹‹å‰ä¼˜å…ˆåŠ è½½ç›®æ ‡bean</p><p><strong>å£°æ˜</strong></p><ul><li>æˆ‘ä¸ªäººè®¤ä¸ºä¸‹é¢è¿™ç§ä½¿ç”¨æ–¹å¼ï¼Œä¾ç„¶å¾ˆä¸ä¼˜é›…ï¼Œå¦‚æœ‰æ›´å¥½æ–¹å¼ï¼Œæ³è¯·å¤§ä½¬ç•™è¨€å‘ŠçŸ¥</li><li>æˆ‘ä¸ªäººè®¤ä¸ºä¸‹é¢è¿™ç§ä½¿ç”¨æ–¹å¼ï¼Œä¾ç„¶å¾ˆä¸ä¼˜é›…ï¼Œå¦‚æœ‰æ›´å¥½æ–¹å¼ï¼Œæ³è¯·å¤§ä½¬ç•™è¨€å‘ŠçŸ¥</li><li>æˆ‘ä¸ªäººè®¤ä¸ºä¸‹é¢è¿™ç§ä½¿ç”¨æ–¹å¼ï¼Œä¾ç„¶å¾ˆä¸ä¼˜é›…ï¼Œå¦‚æœ‰æ›´å¥½æ–¹å¼ï¼Œæ³è¯·å¤§ä½¬ç•™è¨€å‘ŠçŸ¥</li></ul><h3 id="_1-åœºæ™¯åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_1-åœºæ™¯åˆ†æ" aria-hidden="true">#</a> 1. åœºæ™¯åˆ†æ</h3><p>å‡è®¾æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªé…ç½®è¯»å–çš„å·¥å…·åŒ…ï¼Œä½†æ˜¯ä¸åŒçš„åº”ç”¨å¯èƒ½å¯¹é…ç½®çš„å­˜å‚¨æœ‰ä¸åŒçš„è¦æ±‚ï¼Œæ¯”å¦‚æœ‰çš„é…ç½®å­˜åœ¨æœ¬åœ°ï¼Œæœ‰çš„å­˜åœ¨dbï¼Œæœ‰çš„é€šè¿‡httpæ–¹å¼è¿œç¨‹è·å–ï¼›è€Œè¿™äº›å­˜å‚¨æ–¹å¼å‘¢ï¼Œé€šè¿‡<code>application.yml</code>é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°<code>config.save.mode</code>æ¥æŒ‡å®š</p><p>è¿™ä¸ªå·¥å…·åŒ…å‘¢ï¼Œä¼šåšä¸€ä»¶äº‹æƒ…ï¼Œæ‰«æåº”ç”¨ç¨‹åºçš„æ‰€æœ‰ç±»ï¼Œå¹¶æ³¨å…¥é…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ä¹‹å‰ï¼Œè¿™ä¸ªå·¥å…·åŒ…å°±å·²ç»ä»æ•°æ®æºè·å–åˆ°äº†é…ç½®ä¿¡æ¯ï¼Œè€Œè¿™åˆè¦æ±‚å…ˆè·å–åº”ç”¨åˆ°åº•æ˜¯ç”¨çš„å“ªä¸ªæ•°æ®æº</p><p>ç®€å•æ¥è®²ï¼Œå°±æ˜¯å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºå·¥ä½œä¹‹å‰ï¼Œ<code>DatasourceLoader</code>è¿™ä¸ªbeanå·²ç»è¢«å®ä¾‹åŒ–äº†</p><p>-- æ’æ’­ä¸€å¥ï¼Œä¸Šé¢è¿™ä¸ªcaseï¼Œæ­£æ˜¯æˆ‘åœ¨ç­¹å¤‡çš„<code>SpringBootå®æˆ˜æ•™ç¨‹--ä»0åˆ°1åˆ›å»ºä¸€ä¸ªé«˜å¯ç”¨çš„é…ç½®ä¸­å¿ƒ</code>çš„å…·ä½“åº”ç”¨åœºæ™¯</p><h3 id="_2-å¸¸è§„æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-å¸¸è§„æµç¨‹" aria-hidden="true">#</a> 2. å¸¸è§„æµç¨‹</h3><p>æ–°å»ºä¸€ä¸ªSpringBooté¡¹ç›®å·¥ç¨‹ï¼Œæºç ä¸­springbootç‰ˆæœ¬ä¸º<code>2.2.1.RELEASE</code></p><p>é¦–å…ˆæˆ‘ä»¬æ¥å®šä¹‰è¿™ä¸ªç›®æ ‡bean: <code>DatasourceLoader</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DatasourceLoader</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Getter</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mode<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DatasourceLoader</span><span class="token punctuation">(</span><span class="token class-name">Environment</span> environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">=</span> environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;config.save.mode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;init DatasourceLoader for:&quot;</span> <span class="token operator">+</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">loadResourcres</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼€å§‹åˆå§‹åŒ–èµ„æº&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› ä¸ºè¿™ä¸ªå·¥ç¨‹ä¸»è¦æ˜¯ä¾›ç¬¬ä¸‰æ–¹ä½¿ç”¨ï¼Œæ‰€ä»¥æŒ‰ç…§SpringBootçš„é€šå¸¸ç©æ³•ï¼Œå£°æ˜ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClientAutoConfiguration</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DatasourceLoader</span> <span class="token function">propertyLoader</span><span class="token punctuation">(</span><span class="token class-name">Environment</span> environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DatasourceLoader</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶ååœ¨èµ„æºç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ <code>META-INF</code>ï¼Œåˆ›å»ºæ–‡ä»¶<code>spring.factories</code>ï¼Œå†…å®¹å¦‚ä¸‹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.git.hui.boot.client.ClientAutoConfiguration
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åä½¿ç”¨æ–¹æ·»åŠ ä¾èµ–ï¼Œå°±å®Œäº†ï¼Ÿï¼Ÿï¼Ÿ</p><p>ä¸Šé¢è¿™å¥—æµç¨‹ï¼Œå±äºä¸€èˆ¬çš„å·¥å…·åŒ…å†™æ³•äº†ï¼Œè¯·æ³¨æ„ï¼Œè¿™ç§æ–¹å¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯åº”ç”¨ç¨‹åºå†…å£°æ˜çš„beanåŠ è½½å®Œæ¯•ä¹‹åï¼Œæ‰ä¼šåŠ è½½ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…ä¸­å£°æ˜çš„beanï¼›ä¹Ÿå°±æ˜¯è¯´é€šè¿‡ä¸Šé¢çš„å†™æ³•ï¼Œ<code>DatasourceLoader</code>å¹¶ä¸ä¼šè¢«ä¼˜å…ˆåŠ è½½ï¼Œä¹Ÿè¾¾ä¸åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼ˆåº”ç”¨éƒ½å¼€å§‹æœåŠ¡äº†ï¼Œç»“æœæ‰€æœ‰çš„é…ç½®éƒ½æ˜¯null)</p><h3 id="_3-ç‰¹æ®Šå†™æ³•" tabindex="-1"><a class="header-anchor" href="#_3-ç‰¹æ®Šå†™æ³•" aria-hidden="true">#</a> 3. ç‰¹æ®Šå†™æ³•</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬å€ŸåŠ©æ‰€æœ‰çš„beanåœ¨å®ä¾‹åŒ–ä¹‹å‰ï¼Œä¼šä¼˜å…ˆæ£€æµ‹æ˜¯å¦å­˜åœ¨<code>InstantiationAwareBeanPostProcessor</code>æ¥å£è¿™ä¸ªç‰¹ç‚¹ï¼Œæ¥å®ç°<code>DatasourceLoader</code>çš„ä¼˜å…ˆåŠ è½½</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClientBeanProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">InstantiationAwareBeanPostProcessorAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">BeanFactoryAware</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>beanFactory <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>
                    <span class="token string">&quot;AutowiredAnnotationBeanPostProcessor requires a ConfigurableListableBeanFactory: &quot;</span> <span class="token operator">+</span> beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>beanFactory <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">;</span>
        <span class="token comment">// é€šè¿‡ä¸»åŠ¨è°ƒç”¨beanFactory#getBeanæ¥æ˜¾ç¤ºå®ä¾‹åŒ–ç›®æ ‡bean</span>
        <span class="token class-name">DatasourceLoader</span> propertyLoader <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">DatasourceLoader</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>propertyLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå€ŸåŠ©<code>beanFactory#getBean</code>æ¥æ‰‹åŠ¨è§¦å‘beançš„å®ä¾‹ï¼Œé€šè¿‡å®ç°<code>BeanFactoryAware</code>æ¥å£æ¥è·å–<code>BeanFactory</code>ï¼Œå› ä¸ºå®ç°<code>InstantiationAwareBeanPostProcessor</code>æ¥å£çš„ç±»ä¼šä¼˜å…ˆäºBeanè¢«å®ä¾‹ï¼Œä»¥æ­¤æ¥é—´æ¥çš„è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„</p><blockquote><p>å…³äºä¸Šé¢è¿™ä¸€å¥—æµç¨‹åˆ†æ, è¯·å…³æ³¨å¾®ä¿¡å…¬ä¼—å·/ä¸ªäººåšå®¢ç«™ç‚¹ï¼Œé™å¾…æºç åˆ†æç¯‡</p></blockquote><p>æ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è®©å®ƒç”Ÿæ•ˆäº†ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨Importæ³¨è§£æ¥å®ç°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ClientAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">ClientBeanProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableOrderClient</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ä¸Šé¢çš„æ³¨è§£ä¸­ï¼Œå¯¼å…¥ä¸Šé¢çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå’Œ<code>ClientBeanProcessor</code>ï¼Œæ‰€ä»¥ä¸Šä¸€èŠ‚ä¸­çš„<code>spring.factories</code>æ–‡ä»¶å¯ä»¥ä¸éœ€è¦å“¦</p><h3 id="_4-æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#_4-æµ‹è¯•" aria-hidden="true">#</a> 4. æµ‹è¯•</h3><p>ä¸Šé¢çš„ä¸»è¦æµç¨‹å°±å®Œäº‹äº†ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦è¿›å…¥æµ‹è¯•ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œæ·»åŠ ä¾èµ–</p><p>å…ˆåŠ ä¸€ä¸ªdemoBean</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoBean</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">DemoBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;demo bean init!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;print demo bean &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åæ˜¯å¯åŠ¨ç±»ï¼Œ <code>@EnableOrderClient</code>è¿™ä¸ªæ³¨è§£å¿…é¡»å¾—æœ‰å“¦</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableOrderClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token class-name">DemoBean</span> demoBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        demoBean<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æˆ‘ä»¬å¯åŠ¨ä¹‹å‰ï¼Œè¯·çŒœæµ‹ä¸€ä¸‹ï¼Œ<code>DemoBean</code>å’Œ<code>DatasourceLoader</code>è¿™é‡Œè¿™ä¸¤ä¸ªbeanï¼Œè°ä¼šä¼˜å…ˆè¢«å®ä¾‹åŒ–ï¼Ÿ</p><p>ä¸‹é¢æ˜¯è¾“å‡ºç»“æœ</p><figure><img src="`+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä»ä¸Šé¢çš„ä¸¤ä¸ªçº¢æ¡†è¾“å‡ºï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬çš„å¯åŠ¨ç±»æŒ‡å®šæ–¹å¼ä¾èµ–çš„beanï¼Œå¹¶ä¸ä¸€å®šä¼šæœ€å…ˆè¢«åŠ è½½å“¦</p><h3 id="_5-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_5-å°ç»“" aria-hidden="true">#</a> 5. å°ç»“</h3><p>æœ€åå°ç»“ä¸€ä¸‹ï¼Œæœ¬æ–‡æå‡ºäº†ä¸¤ç§è®©beanä¼˜å…ˆåŠ è½½çš„æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯åœ¨å¯åŠ¨ç±»çš„æ„é€ æ–¹æ³•ä¸­æ·»åŠ ä¾èµ–ï¼Œä¸€ä¸ªæ˜¯å€ŸåŠ©<code>InstantiationAwareBeanPostProcessorAdapter</code>åœ¨beanå®ä¾‹åŒ–ä¹‹å‰è¢«åˆ›å»ºçš„ç‰¹ç‚¹ï¼Œç»“åˆ<code>BeanFactory</code>æ¥æ‰‹åŠ¨è§¦å‘ç›®æ ‡beançš„åˆ›å»º</p><p>æœ€åé€šè¿‡<code>@Import</code>æ³¨è§£è®©æˆ‘ä»¬çš„<code>BeanPostProcessorAdapter</code>ç”Ÿæ•ˆ</p><p><strong>æœ‰çŸ¥é“å…¶ä»–æ–¹å¼çš„å¤§ä½¬ï¼Œè¯·ä¸åèµæ•™å•Š</strong></p><h2 id="ii-å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#ii-å…¶ä»–" aria-hidden="true">#</a> II. å…¶ä»–</h2><h3 id="_0-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_0-é¡¹ç›®" aria-hidden="true">#</a> 0. é¡¹ç›®</h3>',42),b={href:"https://github.com/liuyueyi/spring-boot-demo",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/liuyueyi/spring-boot-demo/blob/master/spring-case/008-bean-order/",target:"_blank",rel:"noopener noreferrer"},h={href:"https://github.com/liuyueyi/spring-boot-demo/blob/master/spring-case/008-bean-order-client",target:"_blank",rel:"noopener noreferrer"};function y(B,f){const s=l("ExternalLinkIcon");return p(),c("div",null,[d,i(" more "),k,n("blockquote",null,[n("p",null,[a("åœ¨çœ‹ä¸‹æ–‡çš„å®ç°ä¹‹å‰ï¼Œå¢™è£‚æ¨èå…ˆçœ‹ä¸€ä¸‹åšæ–‡: "),n("a",v,[a("ã€SpringBootåŸºç¡€ç³»åˆ—ã€‘æŒ‡å®šBeanåˆå§‹åŒ–é¡ºåºçš„è‹¥å¹²å§¿åŠ¿"),e(s)])])]),m,n("ul",null,[n("li",null,[a("å·¥ç¨‹ï¼š"),n("a",b,[a("https://github.com/liuyueyi/spring-boot-demo"),e(s)])]),n("li",null,[a("æºç ï¼š "),n("ul",null,[n("li",null,[n("a",g,[a("https://github.com/liuyueyi/spring-boot-demo/blob/master/spring-case/008-bean-order/"),e(s)])]),n("li",null,[n("a",h,[a("https://github.com/liuyueyi/spring-boot-demo/blob/master/spring-case/008-bean-order-client"),e(s)])])])])])])}const w=o(r,[["render",y],["__file","15.200317-SpringBootç³»åˆ—æ•™ç¨‹ä¹‹å®æˆ˜ï¼šå¦‚ä½•æŒ‡å®šç‰¹å®šbeanæœ€å…ˆåŠ è½½.html.vue"]]);export{w as default};
