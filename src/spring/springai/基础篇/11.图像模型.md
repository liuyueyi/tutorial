---
order: 11
title: 11.å›¾åƒæ¨¡å‹ç”Ÿæˆå›¾ç‰‡
tag:
  - Spring
  - SpringAI
category:
  - SpringAI
date: 2025-08-04 15:24:07
keywords: SpringAI
---

# 11.å›¾åƒæ¨¡å‹ç”Ÿæˆå›¾ç‰‡

æˆªæ­¢åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ä½“éªŒçš„è¿˜ä»…é™äºèŠå¤©æ¨¡å‹ï¼Œä¸€é—®ä¸€ç­”ï¼Œä¸”éƒ½æ˜¯åŸºäºæ–‡æœ¬çš„äº¤äº’æ–¹å¼ï¼›ç°åœ¨ä¸»æµçš„æ¨¡å‹çš„åº”ç”¨åœºæ™¯ï¼Œæ¶‰åŠå›¾åƒè¯†åˆ«ã€å›¾åƒç”Ÿæˆã€å›¾åƒæ£€ç´¢ã€å›¾åƒå¤„ç†ç­‰ç­‰ï¼ŒSpringAIä¹Ÿæä¾›äº†ç›¸åº”çš„æ¨¡å‹æ¥å£ï¼Œæ–¹ä¾¿å¼€å‘è€…è¿›è¡Œå›¾åƒæ¨¡å‹åº”ç”¨çš„å¼€å‘

æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®ä¾‹ï¼Œæ¥çœ‹ä¸€ä¸‹åœ¨SpringAIä¸­ï¼Œå¦‚ä½•æ¥å…¥å›¾åƒæ¨¡å‹

## ä¸€ã€å‡†å¤‡å·¥ä½œ

é¦–å…ˆè¿˜æ˜¯å¾—å‡†å¤‡ä¸€ä¸ªå¤§æ¨¡å‹çš„å¼€å‘è€…è´¦å·ï¼ŒåŒæ ·çš„ä¸ºäº†ç®€åŒ–å¤§å®¶çš„ä½¿ç”¨æˆæœ¬ï¼Œæˆ‘ä»¬ä¾ç„¶é‡‡ç”¨å…è´¹çš„å¤§æ¨¡å‹ - [æ™ºè°±](https://www.bigmodel.cn/pricing) æ¥å®Œæˆ

### 1. æ¨¡å‹é€‰æ‹©

æ™ºè°±å®˜æ–¹æä¾›äº†ä¸¤ä¸ªå…è´¹çš„å¤šæ¨¡æ€æ¨¡å‹ï¼Œåˆ†åˆ«ä¸º

- CogView-3-Flash: ç”Ÿæˆå›¾ç‰‡
- CogVideoX-Flash: ç”Ÿæˆè§†é¢‘

![](/imgs/column/springai/11-1.webp)

### 2. åˆ›å»ºå¯†é’¥

åœ¨æ™ºæ™®çš„å¼€æ”¾å¹³å°è·å–å¯†é’¥ï¼š[https://open.bigmodel.cn/usercenter/proj-mgmt/apikeys](https://open.bigmodel.cn/usercenter/proj-mgmt/apikeys)

![](/imgs/column/springai/01-3.webp)

ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ æ™ºæ™®çš„å¯†é’¥


### 3. é…ç½®å¯†é’¥

åœ¨é…ç½®æ–‡ä»¶ `application.yml` ä¸­ï¼ŒæŒ‡å®šå¯†é’¥å’Œé»˜è®¤çš„æ¨¡å‹

```yaml
spring:
  ai:
    zhipuai:
      # api-key ä½¿ç”¨ä½ è‡ªå·±ç”³è¯·çš„è¿›è¡Œæ›¿æ¢ï¼›å¦‚æœä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œå¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°è¿›è¡Œè®¾ç½®
      api-key: ${zhipuai-api-key}
      image: # å›¾åƒæ¨¡å‹
        options:
          model: CogView-3-Flash
      chat: # èŠå¤©æ¨¡å‹
        options:
          model: GLM-4-Flash
```

æ³¨æ„ä¸Šé¢çš„ modelï¼Œè¿™é‡Œä½¿ç”¨æ˜¯å›¾åƒç”Ÿæˆçš„æ¨¡å‹ï¼Œä¸å‰é¢ä»‹ç»çš„èŠå¤©æ¨¡å‹ä¸­çš„ `GLM-4-Flash` ä¸ä¸€è‡´

## äºŒã€å›¾åƒæ¨¡å‹ä½¿ç”¨

æ¥ä¸‹æ¥æˆ‘ä»¬æ­£å¼è¿›å…¥å›¾åƒæ¨¡å‹çš„ä½¿ç”¨ç¯èŠ‚ï¼Œå…·ä½“çš„é¡¹ç›®åˆ›å»ºè¿‡ç¨‹ï¼Œä¸ä¹‹å‰çš„å¹¶æ— å·®åˆ«ï¼ŒåŸºæœ¬æµç¨‹åŒ [åˆ›å»ºä¸€ä¸ªSpringAI-Demoå·¥ç¨‹](01.åˆ›å»ºä¸€ä¸ªSpringAI-Demoå·¥ç¨‹.md)

### 1. ä¾èµ–é…ç½®

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.ai</groupId>
        <artifactId>spring-ai-starter-mcp-server-webmvc</artifactId>
    </dependency>
</dependencies>
```

### 2. åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ç”Ÿå›¾çš„æ§åˆ¶å™¨ï¼Œå®šä¹‰ä¸€ä¸ªåŸºäºæ™ºè°±å›¾åƒæ¨¡å‹çš„ç«¯ç‚¹ `/genImg`ï¼Œ ç”Ÿæˆä¹‹åï¼Œå°†è¿”å›çš„å›¾ç‰‡é“¾æ¥ä¸‹è½½å›¾ç‰‡æ–‡ä»¶ï¼Œç›´æ¥è¿”å›ç»™å‰ç«¯

```java
@RestController
public class ImgController {
    private final ImageModel imgModel;

    public ImgController(ZhiPuAiImageModel imgModel) {
        this.imgModel = imgModel;
    }

    /**
     * ç”Ÿæˆå›¾ç‰‡å¹¶è¿”å›
     *
     * @param msg æç¤ºè¯
     * @param res è¿”å›å›¾ç‰‡
     * @throws IOException
     */
    @GetMapping(path = "/genImg", produces = "application/octet-stream")
    public void genImg(String msg, HttpServletResponse res) throws IOException {
        ImageResponse response = imgModel.call(new ImagePrompt(msg,
                ImageOptionsBuilder.builder()
                        .height(1024)
                        .width(1024)
                        .model("CogView-3-Flash")
                        // è¿”å›å›¾ç‰‡ç±»å‹
                        .responseFormat("png")
                        // å›¾åƒé£æ ¼ï¼Œå¦‚ vivid ç”ŸåŠ¨é£æ ¼ï¼Œ natural è‡ªç„¶é£æ ¼
                        .style("natural")
                        .build())
        );
        Image img = response.getResult().getOutput();
        BufferedImage image = ImageIO.read(new URL(img.getUrl()));
        res.setContentType("image/png");
        ImageIO.write(image, "png", res.getOutputStream());
    }
}
```

è¯´æ˜ï¼š

- å…·ä½“çš„ä½¿ç”¨æ–¹å¼ï¼Œç›´æ¥åŸºäº `ImageModel` çš„è°ƒç”¨æ¥å®ç°å›¾ç‰‡ç”Ÿæˆ
- å®æµ‹ï¼š `ImageOptions` ä¸­ `model` å‚æ•°ï¼Œæ¯”å¡«ï¼Œä¸ç„¶ä¸ä¼šä½¿ç”¨é…ç½®ä¸­é»˜è®¤æŒ‡å®šçš„ `CogView-3-Flash`

å®˜æ–¹å®ç°è¿™é‡Œå­˜åœ¨bugï¼Œç”±äºä¼ å‚æ²¡æŒ‡å®šmodelï¼Œè¢«sdkä¸­é»˜è®¤çš„`cogview-3`ç»™è¦†ç›–äº†ï¼ˆè€Œä¸æ˜¯é»˜è®¤é€‰é¡¹ä¸­çš„ `CogView-3-Flash`ï¼‰

![](/imgs/column/springai/11-2.webp)

![](/imgs/column/springai/11-3.webp)

### 3. æµ‹è¯•éªŒè¯

æ¥ä¸‹æ¥æˆ‘ä»¬å¯åŠ¨é¡¹ç›®ï¼ŒéªŒè¯ä¸€ä¸‹å›¾åƒæ¨¡å‹çš„å®é™…è¡¨ç°

![](/imgs/column/springai/11-4.webp)


é¢˜å¤–è¯ï¼šç”Ÿæˆçš„å¡é€šå›¾ç‰‡è¿˜å·®å¼ºäººæ„ï¼Œå¦‚æœæ¢æˆå†™å®é£ï¼Œè¿™ä¸ªæ¨¡å‹çš„è¡¨ç°æ•ˆæœå°±å¾ˆä¸ç†æƒ³äº†ğŸ˜‚ ï¼ˆä¸è¿‡æ¯•ç«Ÿæ˜¯å…è´¹çš„ï¼Œè¿˜èƒ½è¦æ±‚å•¥å‘¢~ï¼‰

è¯·é‡ç‚¹æ³¨æ„ï¼š æ™ºè°±çš„ `ImageModel` çš„å®ç°æ˜¯ä¸æ”¯æŒç”Ÿæˆè§†é¢‘çš„ï¼Œæœ€ç›´æ¥çš„è¯æ®å°±æ˜¯ `ZhiPuAiImageApi` çš„å®ç°ä¸­è®¿é—®çš„pathè·¯å¾„æ˜¯ `/v4/images/generations`ï¼Œè€Œè§†é¢‘çš„è®¿é—®è·¯å¾„åº”è¯¥æ˜¯ `/v4/videos/generations`ï¼Œä¸”äº¤äº’æ–¹å¼ä¹Ÿä¸ä¸€è‡´ï¼ˆè§†é¢‘æ˜¯å¼‚æ­¥æŸ¥è¯¢è¿”å›ç»“æœï¼‰;

ç›®å‰`1.0.0`ç‰ˆæœ¬ä»¥åŠ`1.1.0-SNAPSHOT`çš„`spring-ai-zhipuai`å®¢æˆ·ç«¯ï¼Œæ²¡æœ‰å®ç°è§†é¢‘æ¨¡å‹çš„è®¿é—®ï¼›å¦‚æœ‰éœ€è¦ï¼Œéœ€è‡ªå·±å®ç°

## ä¸‰ã€å°ç»“

æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å›¾åƒæ¨¡å‹çš„ä½¿ç”¨ï¼Œè™½ç„¶æ˜¯ä»¥æ™ºè°±ä¸ºä¾‹è¿›è¡Œçš„å®ä¾‹ä»‹ç»ï¼›å…¶ä»–çš„æ¨¡å‹ä½¿ç”¨å§¿åŠ¿ï¼Œå®é™…ä¹Ÿå·®ä¸å¤šï¼Œé€šç”¨çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹

```java
ImagePrompt prompt = new ImagePrompt("è¿™é‡Œæ˜¯æ–‡ç”Ÿå›¾çš„æç¤ºè¯", ImageOptionsBuilder.builder()
        .height(1024)
        .width(1024)
        .model("CogView-3-Flash")
        .build());
ImageResponse response = imgModel.call(prompt);
```


æ–‡ä¸­æ‰€æœ‰æ¶‰åŠåˆ°çš„ä»£ç ï¼Œå¯ä»¥åˆ°é¡¹ç›®ä¸­è·å– [https://github.com/liuyueyi/spring-ai-demo](https://github.com/liuyueyi/spring-ai-demo/tree/master/S11-image-model)

