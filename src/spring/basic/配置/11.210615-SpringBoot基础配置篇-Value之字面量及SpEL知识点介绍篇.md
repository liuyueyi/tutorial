---
order: 21
title: 11.@Valueä¹‹å­—é¢é‡åŠSpELçŸ¥è¯†ç‚¹ä»‹ç»ç¯‡
banner: /imgs/210615/logo.jpg
tag: 
  - Value
category: 
  - SpringBoot
  - åŸºç¡€ç³»åˆ—
  - é…ç½®
date: 2021-06-15 21:23:35
keywords: springboot @value é…ç½®
---

æ‰¿æ¥ä¸Šä¸€ç¯‡åšæ–‡[ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘@Value ä¸­å“ªäº›ä½ ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247486297&idx=1&sn=9c9014eb80987f8c6ef842b1ae02b155&chksm=fce710f5cb9099e31047b01b9d4f1e454cf31c6b11fdd85f7f896d5392e9db2f519af65fd5d2&token=73054292&lang=zh_CN#rd) ä¸­æåŠåˆ°ä½†æ²¡æœ‰ç»†è¯´çš„çŸ¥è¯†ç‚¹ï¼Œè¿™ä¸€ç¯‡åšæ–‡å°†æ¥çœ‹ä¸€ä¸‹`@Value`é™¤äº†ç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„å±æ€§é…ç½®ä¹‹å¤–ï¼Œå¦å¤–æ”¯æŒçš„ä¸¤ç§å§¿åŠ¿

- å­—é¢é‡è¡¨è¾¾å¼æ”¯æŒ
- SpELè¯­æ³•æ”¯æŒ

<!-- more -->

## I. é¡¹ç›®ç¯å¢ƒ

### 1. é¡¹ç›®ä¾èµ–

æœ¬é¡¹ç›®å€ŸåŠ©`SpringBoot 2.2.1.RELEASE` + `maven 3.5.3` + `IDEA`è¿›è¡Œå¼€å‘

å¼€ä¸€ä¸ªwebæœåŠ¡ç”¨äºæµ‹è¯•

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
</dependencies>
```

## II. @ValueçŸ¥è¯†ç‚¹

ä¸Šä¸€ç¯‡çš„åšæ–‡çŸ¥é“é€šè¿‡`${}`å¯ä»¥è·å–é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„é…ç½®å€¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦å¤–ä¸¤ç§å¸¸è§çš„å§¿åŠ¿

### 1. å­—é¢é‡

å­—é¢é‡çš„ä½¿ç”¨æ¯”è¾ƒç®€å•ï¼Œç›´æ¥åœ¨`@Value`æ³¨è§£ä¸­å†™å¸¸é‡

ä¸€ä¸ªdemoå¦‚ä¸‹

```java
@Value("1 + 2")
private String common;
```

ä¸Šé¢è¿™ç§åˆå§‹åŒ–ä¹‹åï¼Œcommonçš„å€¼ä¼šæ˜¯ `1 + 2`ï¼›å¦‚æœåªæ˜¯è¿™ç§ç”¨æ³•ï¼Œè¿™ä¸ªä¸œè¥¿å°±æœ‰äº›é¸¡è‚‹äº†ï¼Œæˆ‘ç›´æ¥èµ‹å€¼ä¸é¦™å˜›ï¼Œä¸ºå•¥è¿˜æœ‰è¿™æ ·å¤šæ­¤ä¸€ä¸¾å‘¢ï¼Ÿ

å½“ç„¶ç°å®ä¸­ï¼ˆè‡³å°‘æˆ‘æœ‰é™çš„ä»£ç æ¥è§¦ä¸­ï¼‰ï¼Œçº¯ä¸Šé¢è¿™ç§å†™æ³•çš„ä¸å¤šï¼Œæ›´å¸¸è§çš„æ˜¯ä¸‹é¢è¿™ç§

```java
@Value("demo_${auth.jwt.token}")
private String prefixConf;
```

å­—é¢é‡ + é…ç½®è”åˆä½¿ç”¨ï¼Œå¦‚æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶å€¼ä¸º

```yaml
auth:
  jwt:
    token: TOKEN.123
```

ä¸Šé¢çš„prefixConfçš„å–å€¼ï¼Œå®é™…ä¸º `demo_TOKEN.123`


### 2. SpELè¡¨è¾¾å¼

@Valueå¦å¤–ä¸€ä¸ªå¾ˆå¼ºçš„ä½¿ç”¨å§¿åŠ¿æ˜¯æ”¯æŒSpELè¡¨è¾¾å¼ï¼Œè‡³äºSpELæ˜¯ä»€ä¹ˆé¬¼ï¼Œæ¨èæŸ¥çœ‹[ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘SpEL è¯­æ³•æ‰«ç›²ä¸æŸ¥è¯¢æ‰‹å†Œ](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247484665&idx=1&sn=d0e0ee3594ac0faa82c7ded5db178eef&chksm=fce71f55cb90964379e9c3e724c07fe0c43f17acdc77c591d93ec1dbaab3440c4579eec5fc7c&token=73054292&lang=zh_CN#rd)

#### 2.1 åŸºæœ¬å§¿åŠ¿

ä½¿ç”¨å§¿åŠ¿æ˜¯ `#{}`ï¼Œè¡¨ç¤ºè¿™ä¸ªå¤§æ‹¬å¼§é‡Œé¢çš„èµ°SpELè¡¨è¾¾å¼ï¼Œå¦‚ä¸‹

```java
/**
 * å­—ç¬¦ä¸²
 */
@Value("#{'abcd'}")
private String spelStr;

/**
 * åŸºæœ¬è®¡ç®—
 */
@Value("#{1 + 2}")
private String spelVal3;

/**
 * åˆ—è¡¨
 */
@Value("#{{1, 2, 3}}")
private List<Integer> spelList;

/**
 * map
 */
@Value("#{{a: '123', b: 'cde'}}")
private Map spelMap;
```

ä¸Šé¢æ˜¯å‡ ä¸ªåŸºæœ¬çš„caseäº†ï¼Œå­—é¢é‡ï¼Œè¡¨è¾¾å¼ï¼Œåˆ—è¡¨/Mapç­‰ï¼ŒSpELçš„åŸºæœ¬ä½¿ç”¨å§¿åŠ¿ä¸æ‰«ç›²åšæ–‡ä¸­çš„æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæ— å¤–ä¹å°±æ˜¯åœ¨å¤–å±‚å¤šäº†ä¸€ä¸ª`${}`

å½“ç„¶å¦‚æœä»…ä»…åªæ˜¯ä»‹ç»ä¸Šé¢å‡ ä¸ªçš„è¯ï¼Œå°±æœ‰ç‚¹å•è°ƒäº†ï¼ŒSpELä¸€ä¸ªæ¯”è¾ƒå¼ºå¤§çš„å°±æ˜¯å¯ä»¥è®¿é—®beançš„å±æ€§/æ–¹æ³•ï¼Œè¿™å°±ç»™äº†æˆ‘ä»¬å¾ˆå¤šçš„æƒ³åƒç©ºé—´äº†

#### 2.2 è°ƒç”¨é™æ€æ–¹æ³•ï¼š

åœ¨ä¸Šé¢è¿™ä¸ªé…ç½®ç±»`com.git.hui.boot.properties.value.config.SpelProperties`ä¸­æ·»åŠ ä¸€ä¸ªé™æ€æ–¹æ³•

```java
public static String uuid() {
    return "spel_" + UUID.randomUUID().toString().replaceAll("_", ".");
}
```

ç„¶åæˆ‘ä»¬å°è¯•è°ƒç”¨å®ƒ

```java
/**
 * è°ƒç”¨é™æ€æ–¹æ³•
 */
@Value("#{T(com.git.hui.boot.properties.value.config.SpelProperties).uuid()}")
private String spelStaticMethod;
```

è¿™æ ·`spelStaticMethod`å°±ä¼šæ˜¯ä¸€ä¸ª `"spel_"` å¼€å¤´çš„éšæœºå­—ç¬¦ä¸²äº†

**è¯·æ³¨æ„ï¼šå¦‚æœåœ¨ä½ çš„å®é™…ç”Ÿäº§é¡¹ç›®ä¸­ï¼Œå†™å‡ºè¿™æ ·çš„ä»£ç ï¼Œé‚£å¤šåŠæ„å‘³ç€ç¦»æ‰¾ä¸‹å®¶ä¸è¿œäº†**

#### 2.3 åµŒå¥—ä½¿ç”¨

æ¥ä¸‹æ¥å€ŸåŠ©SpELä¸é…ç½®ç»‘å®šçš„åµŒå¥—ä½¿ç”¨ï¼Œæ¥ç¨å¾®è°ƒæ•´ä¸‹ä¸Šé¢çš„å®ç°ï¼ˆå®é™…ä¸Šä¸‹é¢è¿™ç§ç”¨æ³•ä¹Ÿä¸å¸¸è§ï¼Œè™½ç„¶æ²¡é—®é¢˜ï¼Œä½†è¿™ç§ä»£ç å°±å±äºå†™æ—¶ä¸€æ—¶çˆ½ï¼Œç»´æŠ¤ç«è‘¬åœºäº†ğŸ™„ï¼‰

```java
/**
 * è°ƒç”¨é™æ€æ–¹æ³•
 */
@Value("#{T(com.git.hui.boot.properties.value.config.SpelProperties).uuid('${auth.jwt.token}_')}")
private String spelStaticMethod;

public static String uuid(String prefix) {
    return prefix + UUID.randomUUID().toString().replaceAll("_", ".");
}
```

å…³äºåµŒå¥—ä½¿ç”¨ï¼Œä¸‹é¢å†ç»™å‡ºä¸€ä¸ªåŸºç¡€çš„ä½¿ç”¨å§¿åŠ¿ï¼Œä¾›æ‰“å¼€æ€è·¯ç”¨

```java
/**
 * åµŒå¥—ä½¿ç”¨ï¼Œä»é…ç½®ä¸­è·å–å€¼ï¼Œç„¶åæ‰§è¡ŒSpELè¯­å¥
 */
@Value("#{'${auth.jwt.token}'.substring(2)}")
private String spelLen;
```

#### 2.4 Beanæ–¹æ³•è°ƒç”¨

æœ€åå†æ¥ä¸€ä¸ªè®¿é—®beançš„æ–¹æ³•çš„case

å®šä¹‰ä¸€ä¸ªService

```java
@Service
public class RandomService {
    private AtomicInteger cnt = new AtomicInteger(1);

    public String randUid() {
        return cnt.getAndAdd(1) + "_" + UUID.randomUUID().toString();
    }
}
```

ä¸€ä¸ªä½¿ç”¨çš„å§¿åŠ¿å¦‚ä¸‹

```java
/**
 * bean æ–¹æ³•è®¿é—®
 */
@Value("#{randomService.randUid()}")
private String spelBeanMethod;
```

### 3. æµ‹è¯•

æœ€åç»™å‡ºä¸€ä¸ªæ³¨å…¥çš„ç»“æœè¾“å‡ºï¼ŒæŸ¥çœ‹ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆåç¦»é¢„æœŸçš„åœºæ™¯

```java
@RestController
@SpringBootApplication
public class Application {

    @Autowired
    private SpelProperties spelProperties;

    @GetMapping("spel")
    public SpelProperties showSpel() {
        return spelProperties;
    }

    public static void main(String[] args) {
        SpringApplication.run(Application.class);
    }
}
```

![](/imgs/210615/00.jpg)

### 4. å°ç»“

æœ¬ç¯‡åšæ–‡ä¸»è¦ä»‹ç»äº†`@Value`é™¤äº†ç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ä¹‹å¤–ï¼Œå¦å¤–ä¸¤ç§å¸¸è§çš„case

- å­—é¢é‡
- SpELè¡¨è¾¾å¼ï¼šå®šä¹‰åœ¨`#{}`é‡Œé¢

å€ŸåŠ©SpELçš„å¼ºå¤§åŠŸèƒ½ï¼Œå®Œå…¨å¯ä»¥å‘æŒ¥æˆ‘ä»¬çš„è„‘æ´ï¼Œè®©`@Value`ä¿®é¥°çš„å±æ€§åˆå§‹åŒ–ä¸å†å±€é™äºç®€å•çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ä»db,redis,httpè·å–å®Œå…¨æ˜¯å¯è¡Œçš„å˜›ï¼Œæ— éå°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼è€Œå·²

å½“ç„¶è¿™é‡Œè¿˜å­˜åœ¨ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜ï¼Œå°±æ˜¯å€¼åˆ·æ–°çš„æ”¯æŒï¼Œå·²çŸ¥`@Value`åªåœ¨beanåˆå§‹åŒ–æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œåç»­å³ä¾¿é…ç½®å˜æ›´äº†ï¼Œäº¦ä¸ä¼šé‡æ–°æ›´æ”¹è¿™ä¸ªå€¼ï¼Œè¿™ç§è®¾è®¡æœ‰å¥½æœ‰åï¼Œå¥½å¤„å¾ˆæ˜æ˜¾ï¼Œé…ç½®çš„ä¸å˜æ€§å¯ä»¥çœå»å¾ˆå¤šé—®é¢˜ï¼›ç¼ºç‚¹å°±æ˜¯ä¸çµæ´»

é‚£ä¹ˆå¦‚ä½•è®©`@Value`çš„é…ç½®å¯ä»¥åŠ¨æ€åˆ·æ–°å‘¢ï¼Ÿ

å’±ä¹ˆä¸‹ç¯‡åšæ–‡è§ï¼Œæˆ‘æ˜¯ä¸€ç°ç°ï¼Œæ¬¢è¿å…³æ³¨é•¿è‰çš„å…¬ä¼—å·`ä¸€ç°ç°blog`


### III. ä¸èƒ½é”™è¿‡çš„æºç å’Œç›¸å…³çŸ¥è¯†ç‚¹

### 0. é¡¹ç›®

- å·¥ç¨‹ï¼š[https://github.com/liuyueyi/spring-boot-demo](https://github.com/liuyueyi/spring-boot-demo)
- æºç : [https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/002-properties-value](https://github.com/liuyueyi/spring-boot-demo/tree/master/spring-boot/002-properties-value)

**é…ç½®ç³»åˆ—åšæ–‡**

- [ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘è‡ªå®šä¹‰é…ç½®æºçš„ä½¿ç”¨å§¿åŠ¿ä»‹ç»](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247486363&idx=1&sn=259c4396393d6670e1caedd24a4d9af2&chksm=fce71037cb909921d80559c0c48625f678957e4c7f8b12becacda83d120fe13f1eb40166da99&token=1655903804&lang=zh_CN#rd)
- [ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘@Value ä¸­å“ªäº›ä½ ä¸çŸ¥é“çš„çŸ¥è¯†ç‚¹](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247486297&idx=1&sn=9c9014eb80987f8c6ef842b1ae02b155&chksm=fce710f5cb9099e31047b01b9d4f1e454cf31c6b11fdd85f7f896d5392e9db2f519af65fd5d2&scene=21#wechat_redirect)
- [ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘ConfigurationProperties é…ç½®ç»‘å®šä¸­é‚£äº›ä½ ä¸çŸ¥é“çš„äº‹æƒ…](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247485872&idx=1&sn=cb565e467d2d2dc9d69ad80a1f936813&chksm=fce7121ccb909b0a0efe89c94d5eba504cf490e0f0bdd15502def81be8c23b96ea76b5f247c4&scene=21#wechat_redirect)
- [ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘SpringBoot é…ç½®ç¯‡ä¹‹ PropertySource åŠ è½½ Yaml é…ç½®æ–‡ä»¶å®ä¾‹æ¼”ç¤º](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247485754&idx=1&sn=724f1a314f64faaaff580dfac0b58e73&chksm=fce71296cb909b8086442a6ebc982b5ed16b1a7252da2b8af27434c3dd6c757537867433efeb&scene=21#wechat_redirect)
- [ã€SpringBoot åŸºç¡€ç³»åˆ—ã€‘å®ç°ä¸€ä¸ªè‡ªå®šä¹‰é…ç½®åŠ è½½å™¨ï¼ˆåº”ç”¨ç¯‡ï¼‰](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247484640&idx=1&sn=5ac20b68d7b539295dabc0c2aaf81314&chksm=fce71f4ccb90965afb626b437cc618172b2a34d8ff72b2ec30eba71e85ff9330503e0ead9e9a&scene=21#wechat_redirect)
- [SpringBootåŸºç¡€ç¯‡é…ç½®ä¿¡æ¯ä¹‹é…ç½®åˆ·æ–°](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247484056&idx=1&sn=90f705d698b2613bcc269fea98dc993e&chksm=fce71934cb90902264f260b15977fc9bf7e19a3ebf3f779acec2f5842c9a8ff6ac514beebf60&scene=21#wechat_redirect)
- [SpringBootåŸºç¡€ç¯‡é…ç½®ä¿¡æ¯ä¹‹è‡ªå®šä¹‰é…ç½®æŒ‡å®šä¸é…ç½®å†…å¼•ç”¨](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247484054&idx=1&sn=954d2bb34b5ce288dcfc2451cbcd2830&chksm=fce7193acb90902cf2ba829362da0e327d7849f3339e4d61188a03cabeb07af0590056f755d5&scene=21#wechat_redirect)
- [SpringBootåŸºç¡€ç¯‡é…ç½®ä¿¡æ¯ä¹‹å¤šç¯å¢ƒé…ç½®ä¿¡æ¯](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247484053&idx=1&sn=3fc32d8a21a5cadc7b33b11681f272ae&chksm=fce71939cb90902fdc5b352e0d135b395248aa9ef40acd5e145bdd05a62185ff538c66f4fe26&scene=21#wechat_redirect)
- [SpringBootåŸºç¡€ç¯‡é…ç½®ä¿¡æ¯ä¹‹å¦‚ä½•è¯»å–é…ç½®ä¿¡æ¯](http://mp.weixin.qq.com/s?__biz=MzU3MTAzNTMzMQ==&mid=2247484040&idx=1&sn=0b984bc76954f9214ed32ada38bc82d2&chksm=fce71924cb909032ad7a06a12aa71c23afe5698d552f182cc96bb5486b54e5a7332d7ab0736d&scene=21#wechat_redirect)

